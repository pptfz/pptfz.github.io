# ubuntu22.04使用记录





```
/etc/cloud/cloud.cfg.d/99-disable-network-config.cfg

network: {config: disabled}
```







apt update 报错

解决方法：将源中ubuntu全部替换为为ubuntu-ports 

原因分析：机器的cpu是arm架构，默认匹配都是x86 架构处理器的软件包，用错源自然找不到所需的包裹信息，报404错误

```
Err:57 https://mirrors.aliyun.com/ubuntu jammy-updates/main arm64 Packages     
  404  Not Found [IP: 211.100.18.47 443]
Ign:58 https://mirrors.aliyun.com/ubuntu jammy-updates/restricted arm64 Packages
Ign:59 https://mirrors.aliyun.com/ubuntu jammy-updates/universe arm64 Packages 
Ign:60 https://mirrors.aliyun.com/ubuntu jammy-updates/multiverse arm64 Packages
Err:61 https://mirrors.aliyun.com/ubuntu jammy-backports/main arm64 Packages   
  404  Not Found [IP: 211.100.18.47 443]
Ign:62 https://mirrors.aliyun.com/ubuntu jammy-backports/universe arm64 Packages
Reading package lists... Done                                                  
E: Failed to fetch https://mirrors.aliyun.com/ubuntu/dists/jammy/main/binary-arm64/Packages  404  Not Found [IP: 211.100.18.47 443]
E: Failed to fetch https://mirrors.aliyun.com/ubuntu/dists/jammy-security/main/binary-arm64/Packages  404  Not Found [IP: 211.100.18.47 443]
E: Failed to fetch https://mirrors.aliyun.com/ubuntu/dists/jammy-updates/main/binary-arm64/Packages  404  Not Found [IP: 211.100.18.47 443]
E: Failed to fetch https://mirrors.aliyun.com/ubuntu/dists/jammy-backports/main/binary-arm64/Packages  404  Not Found [IP: 211.100.18.47 443]
E: Some index files failed to download. They have been ignored, or old ones used instead.
```



netplan apply 报错

```
WARNING:root:Cannot call Open vSwitch: ovsdb-server.service is not running.
```



解决方法

### **安装 Open vSwitch（包含 `ovsdb-server`）**

`ovsdb-server` 是 **Open vSwitch** 的一个组件，因此你需要安装 **Open vSwitch** 来获取它。

首先，更新你的包列表并安装 **Open vSwitch**：

```
bash


复制编辑
sudo apt update
sudo apt install openvswitch-switch
```

安装后，你可以检查 `ovsdb-server` 服务的状态：

```
bash


复制编辑
sudo systemctl status ovsdb-server
```

### **2. 启动并启用 `ovsdb-server` 服务**

安装后，你可以启动 `ovsdb-server` 服务，并确保它在系统启动时自动启动：

```
bash


复制编辑
sudo systemctl start ovsdb-server
sudo systemctl enable ovsdb-server
```

### **3. 确认 `ovsdb-server` 是否运行**

使用以下命令确认 `ovsdb-server` 服务是否正在运行：

```
bash


复制编辑
sudo systemctl status ovsdb-server
```

如果 `ovsdb-server` 成功启动，你应该不会再看到关于它的警告消息。

### **4. 检查 Open vSwitch 配置**

你可以使用以下命令检查 Open vSwitch 配置：

```
bash


复制编辑
sudo ovs-vsctl show
```

这将显示 Open vSwitch 的当前配置，确认 `ovsdb-server` 已正确运行





禁用防火墙

```
sudo ufw disable
```



安装docker

```
for pkg in docker.io docker-doc docker-compose docker-compose-v2 podman-docker containerd runc; do sudo apt-get remove $pkg; done
```



```
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
```



```
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```