<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤ | æˆ‘çš„ç«™ç‚¹</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pptfz.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://pptfz.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://pptfz.github.io/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤ | æˆ‘çš„ç«™ç‚¹"><meta data-rh="true" name="description" content="kubeadmå®‰è£…å®˜æ–¹æ–‡æ¡£"><meta data-rh="true" property="og:description" content="kubeadmå®‰è£…å®˜æ–¹æ–‡æ¡£"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pptfz.github.io/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤"><link data-rh="true" rel="alternate" href="https://pptfz.github.io/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pptfz.github.io/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SICNXLSDBZ-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="æˆ‘çš„ç«™ç‚¹" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.061a1b25.css">
<script src="/assets/js/runtime~main.19595b7b.js" defer="defer"></script>
<script src="/assets/js/main.1b24f5df.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><div class="announcementBar_mb4j" style="background-color:pink;color:@091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">ä¸€åè¿ç»´ï¼Œä¸¤å°ç”µè„‘ï¼Œä¸‰é¤ä¸å®šï¼Œåªä¸ºè®¾å¤‡å·¥ä½œå››å¹³å…«ç¨³ï¼Œæ‹¼å¾—äº”è„ä¿±æŸï¼Œå…­ç¥æ— ä¸»ï¼Œä»ç„¶ä¸ƒç‚¹èµ·åºŠï¼Œå…«ç‚¹å‡ºå‘ï¼Œæ™šä¸Šä¹ç‚¹ä¸è¿”ï¼Œååˆ†è¾›è‹¦ï¼<br> åå¹´è¿ç»´ï¼Œä¹è½¬åŠŸæˆï¼Œå…«é¢å¼ ç½—ï¼Œå¿™å¾—ä¸ƒçªæµè¡€ï¼Œæ¢å¾—å…­ç¥ä¸å®ï¼Œäº”ä½“æ¬ å®‰ï¼Œä»ç„¶å››å¤„å¥”æ³¢ï¼Œä¸‰æ›´ä¸çœ ï¼Œåªä¸ºä¸¤ä¸ªé“œæ¿ï¼Œä¸€ç”Ÿæ‹¼æï¼</div></div><nav aria-label="ä¸»å¯¼èˆª" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">æˆ‘çš„ç«™ç‚¹</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">ç¬”è®°</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">ğŸ˜‚ ğŸ˜‚  ğŸ˜‚</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/github/githubä¸‹è½½åŠ é€Ÿ">github</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/go/goåŠŸèƒ½è„šæœ¬/k8s/è·å–k8sé›†ç¾¤èµ„æºé…ç½®">go</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/idea/vscode/vscodeå¥½ç”¨çš„æ’ä»¶">idea</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux/big-data/Ambari/CentOS7ä¸­ç”¨Ambariå¿«é€Ÿæ­å»ºå¤§æ•°æ®å¹³å°">linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/macä¸“åŒº/brewå®‰è£…">macä¸“åŒº</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/python/python-other/nginx+django+uwsgiéƒ¨ç½²é¡¹ç›®">python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/web/css/cssåŸºç¡€çŸ¥è¯†">web</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/äº‘åŸç”Ÿ/k8s/helm/helm3å®‰è£…">äº‘åŸç”Ÿ</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/helm/helm3å®‰è£…">k8s</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/helm/helm3å®‰è£…">helm</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8sä¸‹è½½/ä¸‹è½½k8säºŒè¿›åˆ¶åŒ…">k8sä¸‹è½½</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8så‘½ä»¤/kubectl topå‘½ä»¤è§£æ">k8så‘½ä»¤</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/CentOS7.9äºŒè¿›åˆ¶å®‰è£…k8s-v1.20.15">k8så®‰è£…</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/CentOS7.9äºŒè¿›åˆ¶å®‰è£…k8s-v1.20.15">CentOS7.9äºŒè¿›åˆ¶å®‰è£…k8s-v1.20.15</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmåœ¨Rocky linuxä¸Šå®‰è£…k8sé›†ç¾¤">ä½¿ç”¨kubeadmåœ¨Rocky linuxä¸Šå®‰è£…k8sé›†ç¾¤</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤">ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmæ­å»º v1.22.2ç‰ˆæœ¬ kubernetesé›†ç¾¤">ä½¿ç”¨kubeadmæ­å»º v1.22.2ç‰ˆæœ¬ kubernetesé›†ç¾¤</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8så¸¸ç”¨å‘½ä»¤é€ŸæŸ¥">k8så¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8sæ•…éšœ/ä½¿ç”¨configæ–‡ä»¶è¿æ¥k8sé›†ç¾¤é‡åˆ°çš„é—®é¢˜">k8sæ•…éšœ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8sçŸ¥è¯†ç‚¹/k8såŸºç¡€æ“ä½œ">k8sçŸ¥è¯†ç‚¹</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/k8sè¯ä¹¦/kubeamå®‰è£…k8sç”Ÿæˆçš„è¯ä¹¦">k8sè¯ä¹¦</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/å­¦ä¹ å·¥å…·/kind/kindé—®é¢˜">å­¦ä¹ å·¥å…·</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/k8s/ç›‘æ§/metrics-server/metrics server">ç›‘æ§</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/äº‘åŸç”Ÿå·¥å…·/harbor/harborå®‰è£…">äº‘åŸç”Ÿå·¥å…·</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/å®¹å™¨/containerd/containerd é«˜çº§å‘½ä»¤è¡Œå·¥å…· nerdctl">å®¹å™¨</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/äº‘åŸç”Ÿ/ç›‘æ§/prometheus/prometheuså®‰è£…">ç›‘æ§</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/å…¶ä»–/wps/wpså†»ç»“çª—å£">å…¶ä»–</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/åšå®¢å·¥å…·/Docusaurus/Docusaurus å®‰è£…">åšå®¢å·¥å…·</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/æ“ä½œå°æŠ€å·§/linux/linuxä¸€äº›éªšæ“ä½œ">æ“ä½œå°æŠ€å·§</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/æ•°æ®åº“/mongodb/centos7å®‰è£…mongodb">æ•°æ®åº“</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/ç¿»è½¦é—®é¢˜åˆé›†/ç¿»è½¦é—®é¢˜-sshå¯†é’¥é—®é¢˜">ç¿»è½¦é—®é¢˜åˆé›†</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">äº‘åŸç”Ÿ</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">k8s</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">k8så®‰è£…</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><h1>ä½¿ç”¨kubeadmå®‰è£…k8sé›†ç¾¤</h1>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/" target="_blank" rel="noopener noreferrer">kubeadmå®‰è£…å®˜æ–¹æ–‡æ¡£</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å®éªŒç¯å¢ƒ">å®éªŒç¯å¢ƒ<a href="#å®éªŒç¯å¢ƒ" class="hash-link" aria-label="å®éªŒç¯å¢ƒçš„ç›´æ¥é“¾æ¥" title="å®éªŒç¯å¢ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<table><thead><tr><th>è§’è‰²</th><th>IP</th><th>ä¸»æœºå</th><th>containerdç‰ˆæœ¬</th><th>ç¡¬ä»¶é…ç½®</th><th>ç³»ç»Ÿ</th><th>å†…æ ¸</th><th>å®‰è£…ç»„ä»¶</th></tr></thead><tbody><tr><td>master</td><td>10.0.0.10</td><td>k8s-master</td><td>1.7.8</td><td>2c4g</td><td>CentOS7.9</td><td>6.5.8-1.el7.elrepo.x86_64</td><td>kube-apiserverï¼Œkube-controller-managerï¼Œkube-schedulerï¼Œkubeletï¼Œetcd</td></tr><tr><td>node</td><td>10.0.0.10</td><td>k8s-node</td><td>1.7.8</td><td>2c4g</td><td>CentOS7.9</td><td>6.5.8-1.el7.elrepo.x86_64</td><td>kubeletï¼Œkube-proxyï¼Œcontainerdï¼Œetcd</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å‡†å¤‡å¼€å§‹">å‡†å¤‡å¼€å§‹<a href="#å‡†å¤‡å¼€å§‹" class="hash-link" aria-label="å‡†å¤‡å¼€å§‹çš„ç›´æ¥é“¾æ¥" title="å‡†å¤‡å¼€å§‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#%E5%87%86%E5%A4%87%E5%BC%80%E5%A7%8B" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p>
<ul>
<li>æ¯å°æœºå™¨2Gæˆ–æ›´å¤šçš„å†…å­˜</li>
<li>CPU2æ ¸å¿ƒåŠä»¥ä¸Š</li>
<li>é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨ç½‘ç»œäº’é€š</li>
<li>èŠ‚ç‚¹ä¹‹ä¸­ä¸å¯ä»¥æœ‰é‡å¤çš„ <code>ä¸»æœºå</code> ã€<code>MACåœ°å€</code> æˆ– <code>product_uuid</code></li>
<li>å¼€å¯æœºå™¨ä¸Šçš„æŸäº›ç«¯å£ã€‚è¯·å‚è§<a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#check-required-ports" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a>äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</li>
<li>äº¤æ¢åˆ†åŒºçš„é…ç½®ã€‚kubelet çš„é»˜è®¤è¡Œä¸ºæ˜¯åœ¨èŠ‚ç‚¹ä¸Šæ£€æµ‹åˆ° äº¤æ¢å†…å­˜æ—¶æ— æ³•å¯åŠ¨ã€‚ kubelet è‡ª v1.22 èµ·å·²å¼€å§‹æ”¯æŒäº¤æ¢åˆ†åŒºã€‚è‡ª v1.28 èµ·ï¼Œä»…é’ˆå¯¹ cgroup v2 æ”¯æŒäº¤æ¢åˆ†åŒºï¼› kubelet çš„ NodeSwap ç‰¹æ€§é—¨æ§å¤„äº Beta é˜¶æ®µï¼Œä½†é»˜è®¤è¢«ç¦ç”¨ã€‚<!-- -->
<ul>
<li>å¦‚æœ kubelet æœªè¢«æ­£ç¡®é…ç½®ä½¿ç”¨äº¤æ¢åˆ†åŒºï¼Œåˆ™ä½ <strong>å¿…é¡»</strong>ç¦ç”¨äº¤æ¢åˆ†åŒºã€‚ ä¾‹å¦‚ï¼Œ<code>sudo swapoff -a</code> å°†æš‚æ—¶ç¦ç”¨äº¤æ¢åˆ†åŒºã€‚è¦ä½¿æ­¤æ›´æ”¹åœ¨é‡å¯åä¿æŒä¸å˜ï¼Œè¯·ç¡®ä¿åœ¨å¦‚ <code>/etc/fstab</code> ã€<code>systemd.swap</code> ç­‰é…ç½®æ–‡ä»¶ä¸­ç¦ç”¨äº¤æ¢åˆ†åŒºï¼Œå…·ä½“å–å†³äºä½ çš„ç³»ç»Ÿå¦‚ä½•é…ç½®ã€‚</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p><code>kubeadm</code> çš„å®‰è£…æ˜¯é€šè¿‡ä½¿ç”¨åŠ¨æ€é“¾æ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶å®Œæˆçš„ï¼Œå®‰è£…æ—¶å‡è®¾ä½ çš„ç›®æ ‡ç³»ç»Ÿæä¾› <code>glibc</code>ã€‚ è¿™ä¸ªå‡è®¾åœ¨è®¸å¤š Linux å‘è¡Œç‰ˆï¼ˆåŒ…æ‹¬ Debianã€Ubuntuã€Fedoraã€CentOS ç­‰ï¼‰ä¸Šæ˜¯åˆç†çš„ï¼Œ ä½†å¯¹äºä¸åŒ…å«é»˜è®¤ <code>glibc</code> çš„è‡ªå®šä¹‰å’Œè½»é‡çº§å‘è¡Œç‰ˆï¼ˆå¦‚ Alpine Linuxï¼‰ï¼Œæƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚ é¢„æœŸçš„æƒ…å†µæ˜¯ï¼Œå‘è¡Œç‰ˆè¦ä¹ˆåŒ…å« <code>glibc</code>ï¼Œ è¦ä¹ˆæä¾›äº†ä¸€ä¸ª<a href="https://wiki.alpinelinux.org/wiki/Running_glibc_programs" target="_blank" rel="noopener noreferrer">å…¼å®¹å±‚</a>ä»¥æä¾›æ‰€éœ€çš„ç¬¦å·ã€‚</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š-mac-åœ°å€å’Œ-product_uuid-çš„å”¯ä¸€æ€§">ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š MAC åœ°å€å’Œ product_uuid çš„å”¯ä¸€æ€§<a href="#ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š-mac-åœ°å€å’Œ-product_uuid-çš„å”¯ä¸€æ€§" class="hash-link" aria-label="ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š MAC åœ°å€å’Œ product_uuid  çš„å”¯ä¸€æ€§çš„ç›´æ¥é“¾æ¥" title="ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š MAC åœ°å€å’Œ product_uuid çš„å”¯ä¸€æ€§çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#verify-mac-address" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p>
<ul>
<li>ä½ å¯ä»¥ä½¿ç”¨å‘½ä»¤ <code>ip link</code> æˆ– <code>ifconfig -a</code> æ¥è·å–ç½‘ç»œæ¥å£çš„ MAC åœ°å€</li>
<li>å¯ä»¥ä½¿ç”¨ <code>sudo cat /sys/class/dmi/id/product_uuid</code> å‘½ä»¤å¯¹ product_uuid æ ¡éªŒ</li>
</ul>
<p>ä¸€èˆ¬æ¥è®²ï¼Œç¡¬ä»¶è®¾å¤‡ä¼šæ‹¥æœ‰å”¯ä¸€çš„åœ°å€ï¼Œä½†æ˜¯æœ‰äº›è™šæ‹Ÿæœºçš„åœ°å€å¯èƒ½ä¼šé‡å¤ã€‚ Kubernetes ä½¿ç”¨è¿™äº›å€¼æ¥å”¯ä¸€ç¡®å®šé›†ç¾¤ä¸­çš„èŠ‚ç‚¹ã€‚ å¦‚æœè¿™äº›å€¼åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šä¸å”¯ä¸€ï¼Œå¯èƒ½ä¼šå¯¼è‡´å®‰è£…<a href="https://github.com/kubernetes/kubeadm/issues/31" target="_blank" rel="noopener noreferrer">å¤±è´¥</a>ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ£€æŸ¥æ‰€éœ€ç«¯å£">æ£€æŸ¥æ‰€éœ€ç«¯å£<a href="#æ£€æŸ¥æ‰€éœ€ç«¯å£" class="hash-link" aria-label="æ£€æŸ¥æ‰€éœ€ç«¯å£çš„ç›´æ¥é“¾æ¥" title="æ£€æŸ¥æ‰€éœ€ç«¯å£çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#check-required-ports" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p>
<p>å¯ç”¨è¿™äº›<a href="https://kubernetes.io/zh-cn/docs/reference/networking/ports-and-protocols/" target="_blank" rel="noopener noreferrer">å¿…è¦çš„ç«¯å£</a>åæ‰èƒ½ä½¿ Kubernetes çš„å„ç»„ä»¶ç›¸äº’é€šä¿¡ã€‚ å¯ä»¥ä½¿ç”¨ netcat ä¹‹ç±»çš„å·¥å…·æ¥æ£€æŸ¥ç«¯å£æ˜¯å¦å¯ç”¨ï¼Œä¾‹å¦‚ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">nc 127.0.0.1 6443</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½ ä½¿ç”¨çš„ Pod ç½‘ç»œæ’ä»¶ (è¯¦è§åç»­ç« èŠ‚) ä¹Ÿå¯èƒ½éœ€è¦å¼€å¯æŸäº›ç‰¹å®šç«¯å£ã€‚ ç”±äºå„ä¸ª Pod ç½‘ç»œæ’ä»¶çš„åŠŸèƒ½éƒ½æœ‰æ‰€ä¸åŒï¼Œè¯·å‚é˜…ä»–ä»¬å„è‡ªæ–‡æ¡£ä¸­å¯¹ç«¯å£çš„è¦æ±‚ã€‚</p>
<p><strong>masterèŠ‚ç‚¹éœ€è¦å¯ç”¨çš„ç«¯å£</strong></p>
<table><thead><tr><th>åè®®</th><th>æ–¹å‘</th><th>ç«¯å£èŒƒå›´</th><th>ç›®çš„</th><th>ä½¿ç”¨è€…</th></tr></thead><tbody><tr><td>TCP</td><td>å…¥ç«™</td><td>6443</td><td>Kubernetes API server</td><td>æ‰€æœ‰</td></tr><tr><td>TCP</td><td>å…¥ç«™</td><td>2379-2380</td><td>etcd server client API</td><td>kube-apiserver, etcd</td></tr><tr><td>TCP</td><td>å…¥ç«™</td><td>10250</td><td>Kubelet API</td><td>è‡ªèº«, masterèŠ‚ç‚¹</td></tr><tr><td>TCP</td><td>å…¥ç«™</td><td>10259</td><td>kube-scheduler</td><td>è‡ªèº«</td></tr><tr><td>TCP</td><td>å…¥ç«™</td><td>10257</td><td>kube-controller-manager</td><td>è‡ªèº«</td></tr></tbody></table>
<p><strong>nodeèŠ‚ç‚¹éœ€è¦å¯ç”¨çš„ç«¯å£</strong></p>
<table><thead><tr><th>åè®®</th><th>æ–¹å‘</th><th>ç«¯å£èŒƒå›´</th><th>ç›®çš„</th><th>ä½¿ç”¨è€…</th></tr></thead><tbody><tr><td>TCP</td><td>å…¥ç«™</td><td>10250</td><td>Kubelet API</td><td>è‡ªèº«, masterèŠ‚ç‚¹</td></tr><tr><td>TCP</td><td>å…¥ç«™</td><td>30000-32767</td><td>NodePort Servicesâ€ </td><td>æ‰€æœ‰</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…å®¹å™¨è¿è¡Œæ—¶">å®‰è£…å®¹å™¨è¿è¡Œæ—¶<a href="#å®‰è£…å®¹å™¨è¿è¡Œæ—¶" class="hash-link" aria-label="å®‰è£…å®¹å™¨è¿è¡Œæ—¶çš„ç›´æ¥é“¾æ¥" title="å®‰è£…å®¹å™¨è¿è¡Œæ—¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#installing-runtime" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p>
<p>ä¸ºäº†åœ¨ Pod ä¸­è¿è¡Œå®¹å™¨ï¼ŒKubernetes ä½¿ç”¨ <a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes" target="_blank" rel="noopener noreferrer">å®¹å™¨è¿è¡Œæ—¶ï¼ˆContainer Runtimeï¼‰</a>ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubernetes ä½¿ç”¨ <a href="https://kubernetes.io/zh-cn/docs/concepts/overview/components/#container-runtime" target="_blank" rel="noopener noreferrer">å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼ˆContainer Runtime Interfaceï¼ŒCRIï¼‰</a> æ¥ä¸ä½ æ‰€é€‰æ‹©çš„å®¹å™¨è¿è¡Œæ—¶äº¤äº’ã€‚</p>
<p>å¦‚æœä½ ä¸æŒ‡å®šè¿è¡Œæ—¶ï¼Œkubeadm ä¼šè‡ªåŠ¨å°è¯•é€šè¿‡æ‰«æå·²çŸ¥çš„ç«¯ç‚¹åˆ—è¡¨æ¥æ£€æµ‹å·²å®‰è£…çš„å®¹å™¨è¿è¡Œæ—¶ã€‚</p>
<p>å¦‚æœæ£€æµ‹åˆ°æœ‰å¤šä¸ªæˆ–è€…æ²¡æœ‰å®¹å™¨è¿è¡Œæ—¶ï¼Œkubeadm å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯å¹¶è¦æ±‚ä½ æŒ‡å®šä¸€ä¸ªæƒ³è¦ä½¿ç”¨çš„è¿è¡Œæ—¶ã€‚</p>
<p>å‚é˜…<a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/" target="_blank" rel="noopener noreferrer">å®¹å™¨è¿è¡Œæ—¶</a> ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>Docker Engine æ²¡æœ‰ å®ç° <a href="https://kubernetes.io/zh-cn/docs/concepts/architecture/cri/" target="_blank" rel="noopener noreferrer">CRI</a>ï¼Œ è€Œè¿™æ˜¯å®¹å™¨è¿è¡Œæ—¶åœ¨ Kubernetes ä¸­å·¥ä½œæ‰€éœ€è¦çš„ã€‚ ä¸ºæ­¤ï¼Œå¿…é¡»å®‰è£…ä¸€ä¸ªé¢å¤–çš„æœåŠ¡ <a href="https://github.com/Mirantis/cri-dockerd" target="_blank" rel="noopener noreferrer">cri-dockerd</a>ã€‚ cri-dockerd æ˜¯ä¸€ä¸ªåŸºäºä¼ ç»Ÿçš„å†…ç½® Docker å¼•æ“æ”¯æŒçš„é¡¹ç›®ï¼Œ å®ƒåœ¨ 1.24 ç‰ˆæœ¬ä» kubelet ä¸­<a href="https://kubernetes.io/zh-cn/dockershim" target="_blank" rel="noopener noreferrer">ç§»é™¤</a>ã€‚</p></div></div>
<p>ä¸‹é¢çš„è¡¨æ ¼åŒ…æ‹¬è¢«æ”¯æŒçš„æ“ä½œç³»ç»Ÿçš„å·²çŸ¥ç«¯ç‚¹ã€‚</p>
<table><thead><tr><th>è¿è¡Œæ—¶</th><th>Unix åŸŸå¥—æ¥å­—</th></tr></thead><tbody><tr><td>containerd</td><td><code>unix:///var/run/containerd/containerd.sock</code></td></tr><tr><td>CRI-O</td><td><code>unix:///var/run/crio/crio.sock</code></td></tr><tr><td>Docker Engineï¼ˆä½¿ç”¨ cri-dockerdï¼‰</td><td><code>unix:///var/run/cri-dockerd.sock</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®¹å™¨è¿è¡Œæ—¶ç±»å‹">å®¹å™¨è¿è¡Œæ—¶ç±»å‹<a href="#å®¹å™¨è¿è¡Œæ—¶ç±»å‹" class="hash-link" aria-label="å®¹å™¨è¿è¡Œæ—¶ç±»å‹çš„ç›´æ¥é“¾æ¥" title="å®¹å™¨è¿è¡Œæ—¶ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><a href="https://github.com/containerd/containerd" target="_blank" rel="noopener noreferrer">containerd</a></p>
<p><a href="https://github.com/cri-o/cri-o" target="_blank" rel="noopener noreferrer">cri-o</a></p>
<p><a href="https://docs.docker.com/engine/install/#server" target="_blank" rel="noopener noreferrer">docker</a>   <a href="https://github.com/Mirantis/cri-dockerd" target="_blank" rel="noopener noreferrer">cri-dockerd</a></p>
<p><a href="https://docs.mirantis.com/mcr/20.10/install.html" target="_blank" rel="noopener noreferrer">Mirantis Container Runtime</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶">å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶<a href="#å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶" class="hash-link" aria-label="å®‰è£…å’Œé…  ç½®å…ˆå†³æ¡ä»¶çš„ç›´æ¥é“¾æ¥" title="å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="è½¬å‘-ipv4-å¹¶è®©-iptables-çœ‹åˆ°æ¡¥æ¥æµé‡">è½¬å‘ IPv4 å¹¶è®© iptables çœ‹åˆ°æ¡¥æ¥æµé‡<a href="#è½¬å‘-ipv4-å¹¶è®©-iptables-çœ‹åˆ°æ¡¥æ¥æµé‡" class="hash-link" aria-label="è½¬å‘ IPv4 å¹¶è®© iptables çœ‹åˆ°æ¡¥æ¥æµé‡çš„ç›´æ¥é“¾æ¥" title="è½¬å‘ IPv4 å¹¶è®© iptables çœ‹åˆ°æ¡¥æ¥æµé‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#%E8%BD%AC%E5%8F%91-ipv4-%E5%B9%B6%E8%AE%A9-iptables-%E7%9C%8B%E5%88%B0%E6%A1%A5%E6%8E%A5%E6%B5%81%E9%87%8F" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p>
<p>æ‰§è¡Œå‘½ä»¤</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">overlay</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">br_netfilter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo modprobe overlay</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo modprobe br_netfilter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># è®¾ç½®æ‰€éœ€çš„ sysctl å‚æ•°ï¼Œå‚æ•°åœ¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.bridge.bridge-nf-call-iptables  = 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.bridge.bridge-nf-call-ip6tables = 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.ip_forward                 = 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># åº”ç”¨ sysctl å‚æ•°è€Œä¸é‡æ–°å¯åŠ¨</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo sysctl --system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹æŒ‡ä»¤ç¡®è®¤ <code>br_netfilter</code> å’Œ <code>overlay</code> æ¨¡å—è¢«åŠ è½½</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">lsmod | grep br_netfilter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lsmod | grep overlay</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹æŒ‡ä»¤ç¡®è®¤ <code>net.bridge.bridge-nf-call-iptables</code>ã€<code>net.bridge.bridge-nf-call-ip6tables</code> å’Œ <code>net.ipv4.ip_forward</code> ç³»ç»Ÿå˜é‡åœ¨ä½ çš„ <code>sysctl</code> é…ç½®ä¸­è¢«è®¾ç½®ä¸º 1ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sysctl net.bridge.bridge-nf-call-iptables net.bridge.bridge-nf-call-ip6tables net.ipv4.ip_forward</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cgroupé©±åŠ¨">cgroupé©±åŠ¨<a href="#cgroupé©±åŠ¨" class="hash-link" aria-label="cgroupé©±åŠ¨çš„ç›´æ¥é“¾æ¥" title="cgroupé©±åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#cgroup-drivers" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p>
<p>åœ¨ Linux ä¸Šï¼Œ<a href="https://kubernetes.io/zh-cn/docs/reference/glossary/?all=true#term-cgroup" target="_blank" rel="noopener noreferrer">æ§åˆ¶ç»„ï¼ˆCGroupï¼‰</a>ç”¨äºé™åˆ¶åˆ†é…ç»™è¿›ç¨‹çš„èµ„æºã€‚</p>
<p><a href="https://kubernetes.io/docs/reference/generated/kubelet" target="_blank" rel="noopener noreferrer">kubelet</a> å’Œåº•å±‚å®¹å™¨è¿è¡Œæ—¶éƒ½éœ€è¦å¯¹æ¥æ§åˆ¶ç»„æ¥å¼ºåˆ¶æ‰§è¡Œ <a href="https://kubernetes.io/zh-cn/docs/concepts/configuration/manage-resources-containers/" target="_blank" rel="noopener noreferrer">ä¸º Pod å’Œå®¹å™¨ç®¡ç†èµ„æº</a> å¹¶ä¸ºè¯¸å¦‚ CPUã€å†…å­˜è¿™ç±»èµ„æºè®¾ç½®è¯·æ±‚å’Œé™åˆ¶ã€‚è‹¥è¦å¯¹æ¥æ§åˆ¶ç»„ï¼Œkubelet å’Œå®¹å™¨è¿è¡Œæ—¶éœ€è¦ä½¿ç”¨ä¸€ä¸ª <strong>cgroup é©±åŠ¨</strong>ã€‚ å…³é”®çš„ä¸€ç‚¹æ˜¯ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶éœ€ä½¿ç”¨ç›¸åŒçš„ cgroup é©±åŠ¨å¹¶ä¸”é‡‡ç”¨ç›¸åŒçš„é…ç½®ã€‚</p>
<p>å¯ç”¨çš„ cgroup é©±åŠ¨æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#cgroupfs-cgroup-driver" target="_blank" rel="noopener noreferrer"><code>cgroupfs</code></a></li>
<li><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#systemd-cgroup-driver" target="_blank" rel="noopener noreferrer"><code>systemd</code></a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cgroupfs-é©±åŠ¨">cgroupfs é©±åŠ¨<a href="#cgroupfs-é©±åŠ¨" class="hash-link" aria-label="cgroupfs é©±åŠ¨çš„ç›´æ¥é“¾æ¥" title="cgroupfs é©±åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><code>cgroupfs</code> é©±åŠ¨æ˜¯ <a href="https://kubernetes.io/zh-cn/docs/reference/config-api/kubelet-config.v1beta1" target="_blank" rel="noopener noreferrer">kubelet ä¸­é»˜è®¤çš„ cgroup é©±åŠ¨</a>ã€‚ å½“ä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨æ—¶ï¼Œ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶å°†ç›´æ¥å¯¹æ¥ cgroup æ–‡ä»¶ç³»ç»Ÿæ¥é…ç½® cgroupã€‚</p>
<p>å½“ <a href="https://www.freedesktop.org/wiki/Software/systemd/" target="_blank" rel="noopener noreferrer">systemd</a> æ˜¯åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œ <strong>ä¸</strong> æ¨èä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨ï¼Œå› ä¸º systemd æœŸæœ›ç³»ç»Ÿä¸Šåªæœ‰ä¸€ä¸ª cgroup ç®¡ç†å™¨ã€‚ æ­¤å¤–ï¼Œå¦‚æœä½ ä½¿ç”¨ <a href="https://kubernetes.io/zh-cn/docs/concepts/architecture/cgroups" target="_blank" rel="noopener noreferrer">cgroup v2</a>ï¼Œ åˆ™åº”ç”¨ <code>systemd</code> cgroup é©±åŠ¨å–ä»£ <code>cgroupfs</code>ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="systemd-cgroup-é©±åŠ¨">systemd cgroup é©±åŠ¨<a href="#systemd-cgroup-é©±åŠ¨" class="hash-link" aria-label="systemd cgroup é©±åŠ¨çš„ç›´æ¥é“¾æ¥" title="systemd cgroup é©±åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å½“æŸä¸ª Linux ç³»ç»Ÿå‘è¡Œç‰ˆä½¿ç”¨ <a href="https://www.freedesktop.org/wiki/Software/systemd/" target="_blank" rel="noopener noreferrer">systemd</a> ä½œä¸ºå…¶åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œåˆå§‹åŒ–è¿›ç¨‹ä¼šç”Ÿæˆå¹¶ä½¿ç”¨ä¸€ä¸ª root æ§åˆ¶ç»„ï¼ˆ<code>cgroup</code>ï¼‰ï¼Œå¹¶å……å½“ cgroup ç®¡ç†å™¨ã€‚</p>
<p>systemd ä¸ cgroup é›†æˆç´§å¯†ï¼Œå¹¶å°†ä¸ºæ¯ä¸ª systemd å•å…ƒåˆ†é…ä¸€ä¸ª cgroupã€‚ å› æ­¤ï¼Œå¦‚æœä½  <code>systemd</code> ç”¨ä½œåˆå§‹åŒ–ç³»ç»Ÿï¼ŒåŒæ—¶ä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨ï¼Œåˆ™ç³»ç»Ÿä¸­ä¼šå­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ cgroup ç®¡ç†å™¨ã€‚</p>
<p>åŒæ—¶å­˜åœ¨ä¸¤ä¸ª cgroup ç®¡ç†å™¨å°†é€ æˆç³»ç»Ÿä¸­é’ˆå¯¹å¯ç”¨çš„èµ„æºå’Œä½¿ç”¨ä¸­çš„èµ„æºå‡ºç°ä¸¤ä¸ªè§†å›¾ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œ å°† kubelet å’Œå®¹å™¨è¿è¡Œæ—¶é…ç½®ä¸ºä½¿ç”¨ <code>cgroupfs</code>ã€ä½†ä¸ºå‰©ä½™çš„è¿›ç¨‹ä½¿ç”¨ <code>systemd</code> çš„é‚£äº›èŠ‚ç‚¹å°†åœ¨èµ„æºå‹  åŠ›å¢å¤§æ—¶å˜å¾—ä¸ç¨³å®šã€‚</p>
<p>å½“ systemd æ˜¯é€‰å®šçš„åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œç¼“è§£è¿™ä¸ªä¸ç¨³å®šé—®é¢˜çš„æ–¹æ³•æ˜¯é’ˆå¯¹ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶å°† <code>systemd</code> ç”¨ä½œ cgroup é©±åŠ¨ã€‚</p>
<p>è¦å°† <code>systemd</code> è®¾ç½®ä¸º cgroup é©±åŠ¨ï¼Œéœ€ç¼–è¾‘ <a href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubelet-config-file/" target="_blank" rel="noopener noreferrer"><code>KubeletConfiguration</code></a> çš„ <code>cgroupDriver</code> é€‰é¡¹ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸º <code>systemd</code>ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubelet.config.k8s.io/v1beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> KubeletConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">cgroupDriver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> systemd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>ä» v1.22 å¼€å§‹ï¼Œåœ¨ä½¿ç”¨ kubeadm åˆ›å»ºé›†ç¾¤æ—¶ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰åœ¨ <code>KubeletConfiguration</code> ä¸‹è®¾ç½® <code>cgroupDriver</code> å­—æ®µï¼Œkubeadm é»˜è®¤ä½¿ç”¨ <code>systemd</code>ã€‚</p></div></div>
<p>åœ¨ Kubernetes v1.28 ä¸­ï¼Œå¯ç”¨ <code>KubeletCgroupDriverFromCRI</code> <a href="https://kubernetes.io/zh-cn/docs/reference/command-line-tools-reference/feature-gates/" target="_blank" rel="noopener noreferrer">ç‰¹æ€§é—¨æ§</a>ç»“åˆæ”¯æŒ <code>RuntimeConfig</code> CRI RPC çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œkubelet ä¼šè‡ªåŠ¨ä»è¿è¡Œæ—¶æ£€æµ‹é€‚å½“çš„ Cgroup é©±åŠ¨ç¨‹åºï¼Œå¹¶å¿½ç•¥ kubelet é…ç½®ä¸­çš„ <code>cgroupDriver</code> è®¾ç½®ã€‚</p>
<p>å¦‚æœä½ å°† <code>systemd</code> é…ç½®ä¸º kubelet çš„ cgroup é©±åŠ¨ï¼Œä½ ä¹Ÿå¿…é¡»å°† <code>systemd</code> é…ç½®ä¸ºå®¹å™¨è¿è¡Œæ—¶çš„ cgroup é©±åŠ¨ã€‚å‚é˜…å®¹å™¨è¿è¡Œæ—¶æ–‡æ¡£ï¼Œäº†è§£æŒ‡ç¤ºè¯´æ˜ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#containerd-systemd" target="_blank" rel="noopener noreferrer">containerd</a></li>
<li><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#cri-o" target="_blank" rel="noopener noreferrer">CRI-O</a></li>
</ul>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>æ³¨æ„</div><div class="admonitionContent_BuS1"><p>æ³¨æ„ï¼šæ›´æ”¹å·²åŠ å…¥é›†ç¾¤çš„èŠ‚ç‚¹çš„ cgroup é©±åŠ¨æ˜¯ä¸€é¡¹æ•æ„Ÿçš„æ“ä½œã€‚ å¦‚æœ kubelet å·²ç»ä½¿ç”¨æŸ cgroup é©±åŠ¨çš„è¯­ä¹‰åˆ›å»ºäº† Podï¼Œæ›´æ”¹è¿è¡Œæ—¶ä»¥ä½¿ç”¨åˆ«çš„ cgroup é©±åŠ¨ï¼Œå½“ä¸ºç°æœ‰ Pod é‡æ–°åˆ›å»º PodSandbox æ—¶ä¼šäº§ç”Ÿé”™è¯¯ã€‚ é‡å¯ kubelet ä¹Ÿå¯èƒ½æ— æ³•è§£å†³æ­¤ç±»é—®é¢˜ã€‚</p><p>å¦‚æœä½ æœ‰åˆ‡å®å¯è¡Œçš„è‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼Œä½¿ç”¨å…¶ä»–å·²æ›´æ–°é…ç½®çš„èŠ‚ç‚¹æ¥æ›¿æ¢è¯¥èŠ‚ç‚¹ï¼Œ æˆ–è€…ä½¿ç”¨è‡ªåŠ¨åŒ–æ–¹æ¡ˆæ¥é‡æ–°å®‰è£…ã€‚</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…containerd">å®‰è£…containerd<a href="#å®‰è£…containerd" class="hash-link" aria-label="å®‰è£…containerdçš„ç›´æ¥é“¾æ¥" title="å®‰è£…containerdçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…containerd-1">å®‰è£…containerd<a href="#å®‰è£…containerd-1" class="hash-link" aria-label="å®‰è£…containerdçš„ç›´æ¥é“¾æ¥" title="å®‰è£…containerdçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/containerd/containerd/blob/main/RELEASES.md#kubernetes-support" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹k8så’Œcontainerdç‰ˆæœ¬å…¼å®¹å…³ç³»</a></p>
<p><a href="https://github.com/containerd/containerd/blob/main/docs/getting-started.md" target="_blank" rel="noopener noreferrer">containerdå®˜æ–¹å®‰è£…æ–‡æ¡£</a></p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>æ³¨æ„</div><div class="admonitionContent_BuS1"><p>ä»v1.6ç‰ˆæœ¬å¼€å§‹ï¼Œæ†ç»‘åŒ… <code>cri-containerd-*.tar.gz</code> å·²ç»è¢«å¼ƒç”¨ï¼Œå¹¶ä¸”ä¼šåœ¨v2.0ç‰ˆæœ¬åˆ é™¤ï¼Œè¿™é‡Œæœ‰ <a href="https://github.com/containerd/containerd/blob/main/RELEASES.md#deprecated-features" target="_blank" rel="noopener noreferrer">å®˜æ–¹è¯´æ˜</a></p></div></div>
<p>ä¸‹è½½å®‰è£…åŒ…</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CONTAINERD_VERSION=1.7.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://github.com/containerd/containerd/releases/download/v${CONTAINERD_VERSION}/containerd-${CONTAINERD_VERSION}-linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å‹ç¼©åŒ…å†…å®¹å¦‚ä¸‹</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ tar tf containerd-1.7.8-linux-amd64.tar.gz </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/containerd-shim-runc-v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/containerd-stress</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/containerd-shim-runc-v2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/containerd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/containerd-shim</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/ctr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è§£å‹ç¼©</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar Cxzvf /usr/local containerd-${CONTAINERD_VERSION}-linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½¿ç”¨systemdç®¡ç†containerd</p>
<p>ä¸‹è½½æ–‡ä»¶</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl https://raw.githubusercontent.com/containerd/containerd/main/containerd.service -o /usr/lib/systemd/system/containerd.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>containerd.service</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Copyright The containerd Authors.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># you may not use this file except in compliance with the License.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># You may obtain a copy of the License at</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#     http://www.apache.org/licenses/LICENSE-2.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Unless required by applicable law or agreed to in writing, software</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># See the License for the specific language governing permissions and</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># limitations under the License.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Description=containerd container runtime</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Documentation=https://containerd.io</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">After=network.target local-fs.target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStartPre=-/sbin/modprobe overlay</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStart=/usr/local/bin/containerd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Type=notify</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Delegate=yes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">KillMode=process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Restart=always</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RestartSec=5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Having non-zero Limit*s causes performance problems due to accounting overhead</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># in the kernel. We recommend using cgroups to do container-local accounting.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LimitNPROC=infinity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LimitCORE=infinity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Comment TasksMax if your systemd version does not supports it.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Only systemd 226 and above support this version.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TasksMax=infinity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">OOMScoreAdjust=-999</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é‡æ–°åŠ è½½ systemd çš„é…ç½®å¹¶è®¾ç½®containerdæœåŠ¡å¼€æœºè‡ªå¯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl enable --now containerd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…runc">å®‰è£…runc<a href="#å®‰è£…runc" class="hash-link" aria-label="å®‰è£…runcçš„ç›´æ¥é“¾æ¥" title="å®‰è£…runcçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/opencontainers/runc" target="_blank" rel="noopener noreferrer">runc githubåœ°å€</a></p>
<p>ä¸‹è½½å®‰è£…åŒ…</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export RUNC_VERSION=1.1.9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://github.com/opencontainers/runc/releases/download/v${RUNC_VERSION}/runc.amd64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">install -m 755 runc.amd64 /usr/local/sbin/runc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>éªŒè¯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ runc -v</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">runc version 1.1.9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">commit: v1.1.9-0-gccaecfcb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">spec: 1.0.2-dev</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go: go1.20.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">libseccomp: 2.5.4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…cniæ’ä»¶">å®‰è£…CNIæ’ä»¶<a href="#å®‰è£…cniæ’ä»¶" class="hash-link" aria-label="å®‰è£…CNIæ’ä»¶çš„ç›´æ¥é“¾æ¥" title="å®‰è£…CNIæ’ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/containernetworking/plugins" target="_blank" rel="noopener noreferrer">CNIæ’ä»¶githubåœ°å€</a></p>
<p>ä¸‹è½½å®‰è£…åŒ…</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CNI_VERSION=1.3.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://github.com/containernetworking/plugins/releases/download/v${CNI_VERSION}/cni-plugins-linux-amd64-v${CNI_VERSION}.tgz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…åŒ…å†…å®¹å¦‚ä¸‹</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ tar tf cni-plugins-linux-amd64-v1.3.0.tgz </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bandwidth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./ptp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./vlan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./host-device</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./tuning</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./vrf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./sbr</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./tap</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./dhcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./static</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./firewall</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./macvlan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./dummy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bridge</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./ipvlan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./portmap</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./host-local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è§£å‹ç¼©</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar Cxzvf /usr/local/bin cni-plugins-linux-amd64-v${CNI_VERSION}.tgz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é…ç½®containerd">é…ç½®containerd<a href="#é…ç½®containerd" class="hash-link" aria-label="é…ç½®containerdçš„ç›´æ¥é“¾æ¥" title="é…ç½®containerdçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="åˆ›å»ºcontainerdé…ç½®æ–‡ä»¶">åˆ›å»ºcontainerdé…ç½®æ–‡ä»¶<a href="#åˆ›å»ºcontainerdé…ç½®æ–‡ä»¶" class="hash-link" aria-label="åˆ›å»ºcontainerdé…ç½®æ–‡ä»¶çš„ç›´æ¥é“¾æ¥" title="åˆ›å»ºcontainerdé…ç½®æ–‡ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/containerd/containerd/blob/main/docs/getting-started.md#advanced-topics" target="_blank" rel="noopener noreferrer">å®˜æ–¹è¯´æ˜æ–‡æ¡£</a></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p /etc/containerd &amp;&amp; containerd config default &gt; /etc/containerd/config.toml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="é…ç½®-systemd-group-é©±åŠ¨">é…ç½® systemd group é©±åŠ¨<a href="#é…ç½®-systemd-group-é©±åŠ¨" class="hash-link" aria-label="é…ç½® systemd group é©±åŠ¨çš„ç›´æ¥é“¾æ¥" title="é…ç½® systemd group é©±åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>å½“ <a href="https://www.freedesktop.org/wiki/Software/systemd/" target="_blank" rel="noopener noreferrer">systemd</a> æ˜¯åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œ <strong>ä¸</strong> æ¨èä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨ï¼Œå› ä¸º systemd æœŸæœ›ç³»ç»Ÿä¸Šåªæœ‰ä¸€ä¸ª cgroup ç®¡ç†å™¨ã€‚ æ­¤å¤–ï¼Œå¦‚æœä½ ä½¿ç”¨ <a href="https://kubernetes.io/zh-cn/docs/concepts/architecture/cgroups" target="_blank" rel="noopener noreferrer">cgroup v2</a>ï¼Œ åˆ™åº”ç”¨ <code>systemd</code> cgroup é©±åŠ¨å–ä»£ <code>cgroupfs</code>ã€‚</p><p>å½“æŸä¸ª Linux ç³»ç»Ÿå‘è¡Œç‰ˆä½¿ç”¨ <a href="https://www.freedesktop.org/wiki/Software/systemd/" target="_blank" rel="noopener noreferrer">systemd</a> ä½œä¸ºå…¶åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œåˆå§‹åŒ–è¿›ç¨‹ä¼šç”Ÿæˆå¹¶ä½¿ç”¨ä¸€ä¸ª root æ§åˆ¶ç»„ï¼ˆ<code>cgroup</code>ï¼‰ï¼Œå¹¶å……å½“ cgroup ç®¡ç†å™¨ã€‚</p><p>systemd ä¸ cgroup é›†æˆç´§å¯†ï¼Œå¹¶å°†ä¸ºæ¯ä¸ª systemd å•å…ƒåˆ†é…ä¸€ä¸ª cgroupã€‚ å› æ­¤ï¼Œå¦‚æœä½  <code>systemd</code> ç”¨ä½œåˆå§‹åŒ–ç³»ç»Ÿï¼ŒåŒæ—¶ä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨ï¼Œåˆ™ç³»ç»Ÿä¸­ä¼šå­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ cgroup ç®¡ç†å™¨ã€‚</p><p>åŒæ—¶å­˜åœ¨ä¸¤ä¸ª cgroup ç®¡ç†å™¨å°†é€ æˆç³»ç»Ÿä¸­é’ˆå¯¹å¯ç”¨çš„èµ„æºå’Œä½¿ç”¨ä¸­çš„èµ„æºå‡ºç°ä¸¤ä¸ªè§†å›¾ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œ å°† kubelet å’Œå®¹å™¨è¿è¡Œæ—¶é…ç½®ä¸ºä½¿ç”¨ <code>cgroupfs</code>ã€ä½†ä¸ºå‰©ä½™çš„è¿›ç¨‹ä½¿ç”¨ <code>systemd</code> çš„é‚£äº›èŠ‚ç‚¹å°†åœ¨èµ„æºå‹åŠ›å¢å¤§æ—¶å˜å¾—ä¸ç¨³å®šã€‚</p><p>å½“ systemd æ˜¯é€‰å®šçš„åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œç¼“è§£è¿™ä¸ªä¸ç¨³å®šé—®é¢˜çš„æ–¹æ³•æ˜¯é’ˆå¯¹ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶å°† <code>systemd</code> ç”¨ä½œ cgroup é©±åŠ¨ã€‚</p></div></div>
<p>ä¿®æ”¹ <code>/etc/containerd/config.toml</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ä¿®æ”¹</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SystemdCgroup = false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ä¿®æ”¹ä¸º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SystemdCgroup = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç”¨å¦‚ä¸‹å‘½ä»¤ä¿®æ”¹</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i.bak &#x27;s/SystemdCgroup = false/SystemdCgroup = true/&#x27; /etc/containerd/config.toml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ä¿®æ”¹-pause-é•œåƒåœ°å€">ä¿®æ”¹ pause é•œåƒåœ°å€<a href="#ä¿®æ”¹-pause-é•œåƒåœ°å€" class="hash-link" aria-label="ä¿®æ”¹ pause é•œåƒåœ°å€çš„ç›´æ¥é“¾æ¥" title="ä¿®æ”¹ pause é•œåƒåœ°å€çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>åœ¨ <code>/etc/containerd/config.toml</code> é…ç½®æ–‡ä»¶ä¸­ï¼Œpauseé•œåƒçš„é»˜è®¤åœ°å€æ˜¯ <code>registry.k8s.io/pause:3.8</code>ï¼Œç”±äºæŸäº›ç‰¹æ®ŠåŸå› ï¼Œéœ€è¦ä¿®æ”¹è¿™ä¸ªé•œåƒçš„åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨ucloudæä¾›çš„åŠ é€Ÿåœ°å€</p><p><code>uhub.service.ucloud.cn/996.icu/pause:3.8</code></p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[plugins.&quot;io.containerd.grpc.v1.cri&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ......</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sandbox_image = &quot;registry.k8s.io/pause:3.8&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç”¨å¦‚ä¸‹å‘½ä»¤ä¿®æ”¹</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;s#registry.k8s.io#uhub.service.ucloud.cn/996.icu#&#x27; /etc/containerd/config.toml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="é…ç½®containerdé•œåƒä»“åº“åŠ é€Ÿ">é…ç½®containerdé•œåƒä»“åº“ åŠ é€Ÿ<a href="#é…ç½®containerdé•œåƒä»“åº“åŠ é€Ÿ" class="hash-link" aria-label="é…ç½®containerdé•œåƒä»“åº“åŠ é€Ÿçš„ç›´æ¥é“¾æ¥" title="é…ç½®containerdé•œåƒä»“åº“åŠ é€Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[plugins.&quot;io.containerd.grpc.v1.cri&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  # sandbox_image = &quot;k8s.gcr.io/pause:3.8&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sandbox_image = &quot;registry.aliyuncs.com/k8sxio/pause:3.8&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;docker.io&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        endpoint = [&quot;https://bqr1dr1n.mirror.aliyuncs.com&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;k8s.gcr.io&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        endpoint = [&quot;https://registry.aliyuncs.com/k8sxio&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é‡å¯containerd</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl restart containerd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ systemctl status containerd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">â— containerd.service - containerd container runtime</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Loaded: loaded (/usr/lib/systemd/system/containerd.service; enabled; vendor preset: disabled)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Active: active (running) since Thu 2023-10-26 19:41:04 CST; 6min ago</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Docs: https://containerd.io</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Process: 27269 ExecStartPre=/sbin/modprobe overlay (code=exited, status=0/SUCCESS)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Main PID: 27273 (containerd)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Tasks: 9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Memory: 29.1M</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   CGroup: /system.slice/containerd.service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           â””â”€27273 /usr/local/bin/containerd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.974636799+08:00&quot; level=info msg=&quot;Start subscribing containerd event&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.974851585+08:00&quot; level=info msg=&quot;Start recovering state&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.975620149+08:00&quot; level=info msg=&quot;Start event monitor&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.975638830+08:00&quot; level=info msg=&quot;Start snapshots syncer&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.975648925+08:00&quot; level=info msg=&quot;Start cni network conf syncer for default&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.975655890+08:00&quot; level=info msg=&quot;Start streaming server&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.977412869+08:00&quot; level=info msg=&quot;skipping tracing processor initialization (no tracing plugin)&quot;...kip plugin&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.978883545+08:00&quot; level=info msg=serving... address=/run/containerd/containerd.sock.ttrpc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.978946259+08:00&quot; level=info msg=serving... address=/run/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Oct 26 19:41:05 k8s containerd[27273]: time=&quot;2023-10-26T19:41:04.983535827+08:00&quot; level=info msg=&quot;containerd successfully booted in 0.090335s&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Hint: Some lines were ellipsized, use -l to show in full.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…cri-toolså¯é€‰">å®‰è£…cri-toolsï¼ˆå¯é€‰ï¼‰<a href="#å®‰è£…cri-toolså¯é€‰" class="hash-link" aria-label="å®‰è£…cri-toolsï¼ˆå¯é€‰ï¼‰çš„ç›´æ¥é“¾æ¥" title="å®‰è£…cri-toolsï¼ˆå¯é€‰ï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/kubernetes-sigs/cri-tools" target="_blank" rel="noopener noreferrer">cri-tools githubåœ°å€</a></p>
<p><a href="https://github.com/kubernetes-sigs/cri-tools/blob/master/docs/crictl.md" target="_blank" rel="noopener noreferrer">cri-toolså®˜æ–¹æ–‡æ¡£</a></p>
<p>ä¸‹è½½å®‰è£…åŒ…</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CRICTL_VERSION=1.28.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">https://github.com/kubernetes-sigs/cri-tools/releases/download/v${CRICTL_VERSION}/crictl-v${CRICTL_VERSION}-linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è§£å‹ç¼©</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar Cxzvf /usr/local/bin crictl-v${CRICTL_VERSION}-linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‰§è¡Œå‘½ä»¤æŠ¥é”™</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ crictl images</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WARN[0000] image connect using default endpoints: [unix:///var/run/dockershim.sock unix:///run/containerd/containerd.sock unix:///run/crio/crio.sock unix:///var/run/cri-dockerd.sock]. As the default settings are now deprecated, you should set the endpoint instead. </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERRO[0000] validate service connection: validate CRI v1 image API for endpoint &quot;unix:///var/run/dockershim.sock&quot;: rpc error: code = Unavailable desc = connection error: desc = &quot;transport: Error while dialing: dial unix /var/run/dockershim.sock: connect: no such file or directory&quot; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è§£å†³æ–¹æ³•</p>
<p><a href="https://www.cyberithub.com/solved-error-while-dialing-dial-unix-var-run-dockershim-sock/" target="_blank" rel="noopener noreferrer">è§£å†³æ–¹æ³•é“¾æ¥</a></p>
<p>å› ä¸ºä½¿ç”¨çš„æ˜¯containerdï¼Œå› æ­¤éœ€è¦å°†å®¹å™¨è¿è¡Œæ—¶ä¿®æ”¹ä¸ºcontainerdï¼Œä¿®æ”¹å®Œæˆåå°±å¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤äº†</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">crictl config --set runtime-endpoint=unix:///run/containerd/containerd.sock --set image-endpoint=unix:///run/containerd/containerd.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>/etc/crictl.yaml</code> æ–‡ä»¶å†…å®¹æœ€ç»ˆå¦‚ä¸‹</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ cat /etc/crictl.yaml </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">runtime-endpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> unix</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">///run/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">image-endpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> unix</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">///run/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">pull-image-on-create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">disable-pull-on-run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é…ç½® <code>crictl</code> å‘½ä»¤è¡¥å…¨</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo &quot;source &lt;(crictl completion bash)&quot; &gt;&gt; ~/.bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source ~/.bashrc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…nerdctlå¯é€‰">å®‰è£…nerdctlï¼ˆå¯é€‰ï¼‰<a href="#å®‰è£…nerdctlå¯é€‰" class="hash-link" aria-label="å®‰è£…nerdctlï¼ˆå¯é€‰ï¼‰çš„ç›´æ¥é“¾æ¥" title="å®‰è£…nerdctlï¼ˆå¯é€‰ï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/containerd/nerdctl" target="_blank" rel="noopener noreferrer">nerdctl githubåœ°å€</a></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p><code>nerdctl</code> æ˜¯ä¸€ä¸ªé€‚ç”¨äºcontainerdçš„dcokerå…¼å®¹CLI</p><p>å®‰è£…containerdåéœ€è¦ä½¿ç”¨ <code>ctr</code> å‘½ä»¤ç®¡ç†æ“ä½œå®¹å™¨ï¼Œä½†æ˜¯æ“ä½œå‘½ä»¤ä¸dockerç›¸å·®æ¯”è¾ƒå¤§ï¼Œ <code>nerdctl</code> å°±å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæ—¢èƒ½åœ¨ä½¿ç”¨containerdçš„åŒæ—¶åˆèƒ½ä½¿ç”¨åŸå…ˆdockerå‘½ä»¤çš„ç”¨æ³•</p></div></div>
<p>ä¸‹è½½å®‰è£…åŒ…</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>å¦‚æœæ²¡æœ‰å®‰è£… containerdï¼Œåˆ™å¯ä»¥ä¸‹è½½ <code>nerdctl-full-\&lt;VERSION&gt;-linux-amd64.tar.gz</code> åŒ…è¿›è¡Œå®‰è£…ï¼Œå¹¶ä¸” <code>nerdctl-full</code> è¿™ä¸ªåŒ…æ˜¯ä¸containerdç‰ˆæœ¬ä¸€ä¸€å¯¹åº”çš„ï¼Œå³containerdå‘å¸ƒä¸€ä¸ªç‰ˆæœ¬åï¼Œ<code>nerdctl-full</code> ä¹Ÿéšå³å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬ï¼Œè™½ç„¶2è€…ç‰ˆæœ¬å·ä¸ä¸€è‡´ï¼Œä½†æ˜¯æ˜¯äº’ç›¸å¯¹åº”çš„</p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># è¿™é‡Œå®‰è£…çš„containerdç‰ˆæœ¬ä¸º1.7.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export NERDCTL_VERSION=1.6.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://github.com/containerd/nerdctl/releases/download/v${NERDCTL_VERSION}/nerdctl-${NERDCTL_VERSION}-linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è§£å‹ç¼©</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>å‹ç¼©åŒ…å†…å®¹ä¸º <code>nerdctl</code> å‘½ä»¤ä»¥åŠ <code>containerd-rootless-setuptool.sh</code> å’Œ <code>containerd-rootless.sh</code> ï¼Œå‡æœ‰æ‰§è¡Œæƒé™</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ tar tf nerdctl-${NERDCTL_VERSION}-linux-amd64.tar.gz </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">nerdctl</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">containerd-rootless-setuptool.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">containerd-rootless.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf nerdctl-${NERDCTL_VERSION}-linux-amd64.tar.gz </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‹·è´äºŒè¿›åˆ¶æ–‡ä»¶</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv nerdctl /usr/local/bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é…ç½® <code>nerdctl</code> å‘½ä»¤è¡¥å…¨</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo &quot;source &lt;(nerdctl completion bash)&quot; &gt;&gt; ~/.bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source ~/.bashrc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…å…¶ä»–ç»„ä»¶">å®‰è£…å…¶ä»–ç»„ä»¶<a href="#å®‰è£…å…¶ä»–ç»„ä»¶" class="hash-link" aria-label="å®‰è£…å…¶ä»–ç»„ä»¶çš„ç›´æ¥é“¾æ¥" title="å®‰è£…å…¶ä»–ç»„ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="cni-plugins-cni-æ’ä»¶-"><a href="https://github.com/containernetworking/plugins" target="_blank" rel="noopener noreferrer">CNI plugins CNI æ’ä»¶ </a><a href="#cni-plugins-cni-æ’ä»¶-" class="hash-link" aria-label="cni-plugins-cni-æ’ä»¶-çš„ç›´æ¥é“¾æ¥" title="cni-plugins-cni-æ’ä»¶-çš„ç›´æ¥é“¾æ¥">â€‹</a></h6>
<p>æ­¤æ’ä»¶ç”¨äºæ‰§è¡Œ <code>nerdctl run</code> å‘½ä»¤ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ v1.1.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æ—§ç‰ˆæœ¬éœ€è¦é¢å¤–çš„ CNI éš”ç¦»æ’ä»¶æ¥éš”ç¦»æ¡¥æ¥ç½‘ç»œ</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="buildkit-æ„å»ºå¥—ä»¶--å¯é€‰"><a href="https://github.com/moby/buildkit" target="_blank" rel="noopener noreferrer">BuildKit æ„å»ºå¥—ä»¶ </a> ï¼ˆå¯é€‰ï¼‰<a href="#buildkit-æ„å»ºå¥—ä»¶--å¯é€‰" class="hash-link" aria-label="buildkit-  æ„å»ºå¥—ä»¶--å¯é€‰çš„ç›´æ¥é“¾æ¥" title="buildkit-æ„å»ºå¥—ä»¶--å¯é€‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h6>
<p>æ­¤æ’ä»¶ç”¨äºæ‰§è¡Œ <code>nerdctl build</code> ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ v0.11.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æŸäº›åŠŸèƒ½ï¼ˆä¾‹å¦‚ä½¿ç”¨ <code>nerdctl system prune</code>ï¼‰ä¸é€‚ç”¨äºæ—§ç‰ˆæœ¬ã€‚</p>
<p>BuildKit å®ˆæŠ¤ç¨‹åºéœ€è¦è¿è¡Œï¼Œå‚è€ƒ <a href="https://github.com/containerd/nerdctl/blob/main/docs/build.md" target="_blank" rel="noopener noreferrer">æœ‰å…³è®¾ç½® BuildKit çš„æ–‡æ¡£</a> ï¼Œå¦åˆ™è¿è¡Œ <code>nerdctl build</code> ä¼šæŠ¥é”™å¦‚ä¸‹</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ nerdctl build</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">build    (Build an image from a Dockerfile. Needs buildkitd to be running.)  builder  (Manage builds)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[root@k8s ~]# nerdctl build -t hehe.com/devops/nginx .</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERRO[0000] `buildctl` needs to be installed and `buildkitd` needs to be running, see https://github.com/moby/buildkit  error=&quot;failed to ping to host unix:///run/buildkit-default/buildkitd.sock: exec: \&quot;buildctl\&quot;: executable file not found in $PATH\nfailed to ping to host unix:///run/buildkit/buildkitd.sock: exec: \&quot;buildctl\&quot;: executable file not found in $PATH&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FATA[0000] no buildkit host is available, tried 2 candidates: failed to ping to host unix:///run/buildkit-default/buildkitd.sock: exec: &quot;buildctl&quot;: executable file not found in $PATH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">failed to ping to host unix:///run/buildkit/buildkitd.sock: exec: &quot;buildctl&quot;: executable file not found in $PATH </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸‹è½½å®‰è£…åŒ…</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export BUILDKIT_VERSION=0.12.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://github.com/moby/buildkit/releases/download/v${BUILDKIT_VERSION}/buildkit-v${BUILDKIT_VERSION}.linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è§£å‹ç¼©</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>å‹ç¼©åŒ…å†…å®¹å¦‚ä¸‹</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ tar tf buildkit-v0.12.3.linux-amd64.tar.gz </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildctl</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-aarch64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-arm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-i386</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-mips64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-mips64el</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-ppc64le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-riscv64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-qemu-s390x</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkit-runc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bin/buildkitd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf buildkit-v${BUILDKIT_VERSION}.linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‹·è´ <code>buildkitd</code> å‘½ä»¤</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cp bin/buildkitd /usr/local/bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¯åŠ¨ <code>buildkitd</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">buildkitd &amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>buildkitd</code> å¯åŠ¨æˆåŠŸåå°±å¯ä»¥æ‰§è¡Œ <code>nerdctl build</code> å‘½ä»¤äº†</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="rootlesskit-and-slirp4netns-å¯é€‰"><a href="https://github.com/rootless-containers/rootlesskit" target="_blank" rel="noopener noreferrer">RootlessKit</a> and <a href="https://github.com/rootless-containers/slirp4netns" target="_blank" rel="noopener noreferrer">slirp4netns</a> ï¼ˆå¯é€‰ï¼‰<a href="#rootlesskit-and-slirp4netns-å¯é€‰" class="hash-link" aria-label="rootlesskit-and-slirp4netns-å¯é€‰çš„ç›´æ¥é“¾æ¥" title="rootlesskit-and-slirp4netns-å¯é€‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h6>
<p>RootlessKit éœ€è¦æ˜¯ v0.10.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æ¨èv0.14.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<p>slirp4netns éœ€è¦æ˜¯ v0.4.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æ¨èv1.1.7æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<p>æ­¤æ’ä»¶ç”¨äº <code>rootless</code> æ¨¡å¼ï¼Œå¯ä»¥å‚è€ƒ<a href="https://docs.docker.com/engine/security/rootless/" target="_blank" rel="noopener noreferrer">dockerå®˜æ–¹å¯¹rootlessæ¨¡å¼çš„è¯´æ˜</a></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>ä»¥ä¸Š3ä¸ªæ’ä»¶åŒ…å«åœ¨ <code>nerdctl-full-&lt;VERSION&gt;-&lt;OS&gt;-&lt;ARCH&gt;.tar.gz</code> ä¸­ï¼Œä½†ä¸åŒ…å«åœ¨ <code>nerdctl-&lt;VERSION&gt;-&lt;OS&gt;-&lt;ARCH&gt;.tar.gz</code> ä¸­</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dockerå’Œcontainerdå¸¸ç”¨å‘½ä»¤å¯¹æ¯”">dockerå’Œcontainerdå¸¸ç”¨å‘½ä»¤å¯¹æ¯”<a href="#dockerå’Œcontainerdå¸¸ç”¨å‘½ä»¤å¯¹æ¯”" class="hash-link" aria-label="dockerå’Œcontainerdå¸¸ç”¨å‘½ä»¤å¯¹æ¯”çš„ç›´æ¥é“¾æ¥" title="dockerå’Œcontainerdå¸¸ç”¨å‘½ä»¤å¯¹æ¯”çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<table><thead><tr><th>å‘½ä»¤</th><th>docker</th><th>crictl</th><th>nerdctl</th><th>ctr</th></tr></thead><tbody><tr><td>æŸ¥çœ‹å®¹å™¨åˆ—è¡¨</td><td><code>docker ps</code></td><td><code>crictl ps</code></td><td><code>nerdctl ps</code></td><td><code>ctr -n k8s.io c ls</code></td></tr><tr><td>æŸ¥çœ‹å®¹å™¨è¯¦æƒ…</td><td><code>docker inspect</code></td><td><code>crictl inspect</code></td><td><code>nerdctl inspect</code></td><td><code>ctr -n k8s.io c info</code></td></tr><tr><td>æŸ¥çœ‹å®¹å™¨æ—¥å¿—</td><td><code>docker logs</code></td><td><code>crictl logs</code></td><td><code>nerdctl logs</code></td><td>æ— </td></tr><tr><td>å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤</td><td><code>docker exec</code></td><td><code>crictl exec</code></td><td><code>nerdctl exec</code></td><td>æ— </td></tr><tr><td>æŒ‚è½½å®¹å™¨</td><td><code>docker attach</code></td><td><code>crictl attach</code></td><td><code>nerdctl attach</code></td><td>æ— </td></tr><tr><td>æ˜¾ç¤ºå®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ</td><td><code>docker stats</code></td><td><code>crictl stats</code></td><td><code>nerdctl stats</code></td><td>æ— </td></tr><tr><td>åˆ›å»ºå®¹å™¨</td><td><code>docker create</code></td><td><code>crictl create</code></td><td><code>nerdctl create</code></td><td><code>ctr -n k8s.io c create</code></td></tr><tr><td>å¯åŠ¨å®¹å™¨</td><td><code>docker start</code></td><td><code>crictl start</code></td><td><code>nerdctl start</code></td><td><code>ctr -n k8s.io run</code></td></tr><tr><td>åœæ­¢å®¹å™¨</td><td><code>docker stop</code></td><td><code>crictl stop</code></td><td><code>nerdctl stop</code></td><td>æ— </td></tr><tr><td>åˆ é™¤å®¹å™¨</td><td><code>docker rm</code></td><td><code>crictl rm</code></td><td><code>nerdctl rm</code></td><td><code>ctr -n k8s.io c del</code></td></tr><tr><td>æŸ¥çœ‹é•œåƒåˆ—è¡¨</td><td><code>docker images</code></td><td><code>crictl images</code></td><td><code>nerdctl images</code></td><td><code>ctr -n k8s.io i ls</code></td></tr><tr><td>æŸ¥çœ‹é•œåƒè¯¦æƒ…</td><td><code>docker inspect</code></td><td><code>crictl inspecti</code></td><td><code>nerdctl inspect</code></td><td>æ— </td></tr><tr><td>æ‹‰å–é•œåƒ</td><td><code>docker pull</code></td><td><code>crictl pull</code></td><td><code>nerdctl pull</code></td><td><code>ctr -n k8s.io i pull</code></td></tr><tr><td>æ¨é€é•œåƒ</td><td><code>docker push</code></td><td>æ— </td><td><code>nerdctl push</code></td><td><code>ctr -n k8s.io i push</code></td></tr><tr><td>åˆ é™¤é•œåƒ</td><td><code>docker rmi</code></td><td><code>crictl rmi</code></td><td><code>nerdctl rmi</code></td><td><code>ctr -n k8s.io i rm</code></td></tr><tr><td>æŸ¥çœ‹Podåˆ—è¡¨</td><td>æ— </td><td><code>crictl pods</code></td><td>æ— </td><td>æ— </td></tr><tr><td>æŸ¥çœ‹Podè¯¦æƒ…</td><td>æ— </td><td><code>crictl inspectp</code></td><td>æ— </td><td>æ— </td></tr><tr><td>å¯åŠ¨Pod</td><td>æ— </td><td><code>crictl runp</code></td><td>æ— </td><td>æ— </td></tr><tr><td>åœæ­¢Pod</td><td>æ— </td><td><code>crictl stop</code></td><td>æ— </td><td>æ— </td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…kubeadmkubeletkubectl">å®‰è£…kubeadmã€kubeletã€kubectl<a href="#å®‰è£…kubeadmkubeletkubectl" class="hash-link" aria-label="å®‰è£…kubeadmã€kubeletã€kubectlçš„ç›´æ¥é“¾æ¥" title="å®‰è£…kubeadmã€kubeletã€kubectlçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é…ç½®yumæº">é…ç½®yumæº<a href="#é…ç½®yumæº" class="hash-link" aria-label="é…ç½®yumæºçš„ç›´æ¥é“¾æ¥" title="é…ç½®yumæºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å®˜æ–¹yumæº</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[kubernetes]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name=Kubernetes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">baseurl=https://pkgs.k8s.io/core:/stable:/v1.28/rpm/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgcheck=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgkey=https://pkgs.k8s.io/core:/stable:/v1.28/rpm/repodata/repomd.xml.key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exclude=kubelet kubeadm kubectl cri-tools kubernetes-cni</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é˜¿é‡Œäº‘yumæº</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[kubernetes]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name=Kubernetes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgcheck=0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">repo_gpgcheck=0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…-kubeletkubeadm-å’Œ-kubectlå¹¶å¯ç”¨-kubelet-ä»¥ç¡®ä¿å®ƒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨">å®‰è£… kubeletã€kubeadm å’Œ kubectlï¼Œå¹¶å¯ç”¨ kubelet ä»¥ç¡®ä¿å®ƒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨<a href="#å®‰è£…-kubeletkubeadm-å’Œ-kubectlå¹¶å¯ç”¨-kubelet-ä»¥ç¡®ä¿å®ƒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨" class="hash-link" aria-label="å®‰è£… kubeletã€kubeadm å’Œ kubectlï¼Œå¹¶å¯ç”¨ kubelet ä»¥ç¡®ä¿å®ƒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="å®‰è£… kubeletã€kubeadm å’Œ kubectlï¼Œå¹¶å¯ç”¨ kubelet ä»¥ç¡®ä¿å®ƒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æŸ¥çœ‹å¯å®‰è£…çš„ç‰ˆæœ¬</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum list kubeadm --showduplicates</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŒ‡å®šå®‰è£…ç‰ˆæœ¬</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export K8S_VERSION=1.28.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum -y install kubelet-${K8S_VERSION} kubeadm-${K8S_VERSION} kubectl-${K8S_VERSION} --disableexcludes=kubernetes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl enable --now kubelet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…æœ€æ–°ç‰ˆ</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl enable --now kubelet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è®¾ç½®-kubectl-å‘½ä»¤è¡¥å…¨">è®¾ç½® <code>kubectl</code> å‘½ä»¤è¡¥å…¨<a href="#è®¾ç½®-kubectl-å‘½ä»¤è¡¥å…¨" class="hash-link" aria-label="è®¾ç½®-kubectl-å‘½ä»¤è¡¥å…¨çš„ç›´æ¥é“¾æ¥" title="è®¾ç½®-kubectl-å‘½ä»¤è¡¥å…¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum -y install bash-completion </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä½¿ç”¨kubeadmåˆ›å»ºé›†ç¾¤">ä½¿ç”¨kubeadmåˆ›å»ºé›†ç¾¤<a href="#ä½¿ç”¨kubeadmåˆ›å»ºé›†ç¾¤" class="hash-link" aria-label="ä½¿ç”¨kubeadmåˆ›å»ºé›†ç¾¤çš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨kubeadmåˆ›å»ºé›†ç¾¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åˆå§‹åŒ–masterèŠ‚ç‚¹">åˆå§‹åŒ–masterèŠ‚ç‚¹<a href="#åˆå§‹åŒ–masterèŠ‚ç‚¹" class="hash-link" aria-label="åˆå§‹åŒ–masterèŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥" title="åˆå§‹åŒ–masterèŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¯æ‰§è¡Œ <code>kubeadm config print init-defaults</code> æŸ¥çœ‹é»˜è®¤é…ç½®</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubeadm config print init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">defaults</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">bootstrapTokens</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">groups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">bootstrappers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">kubeadm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">token</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> abcdef.0123456789abcdef</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ttl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 24h0m0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">usages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> signing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> authentication</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> InitConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">localAPIEndpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">advertiseAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1.2.3.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">bindPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">nodeRegistration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">criSocket</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> unix</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">///var/run/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">imagePullPolicy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> IfNotPresent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">taints</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiServer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">timeoutForControlPlane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 4m0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">certificatesDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /etc/kubernetes/pki</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">clusterName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubernetes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">controllerManager</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">dns</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">etcd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">local</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dataDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /var/lib/etcd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">imageRepository</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> registry.k8s.io</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kubernetesVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1.30.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">networking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dnsDomain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cluster.local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">serviceSubnet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.96.0.0/12</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">scheduler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="åˆå§‹åŒ–æ–¹å¼">åˆå§‹åŒ–æ–¹å¼<a href="#åˆå§‹åŒ–æ–¹å¼" class="hash-link" aria-label="åˆå§‹åŒ–æ–¹å¼çš„ç›´æ¥é“¾æ¥" title="åˆå§‹åŒ–æ–¹å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="é…ç½®æ–‡ä»¶æ–¹å¼">é…ç½®æ–‡  ä»¶æ–¹å¼<a href="#é…ç½®æ–‡ä»¶æ–¹å¼" class="hash-link" aria-label="é…ç½®æ–‡ä»¶æ–¹å¼çš„ç›´æ¥é“¾æ¥" title="é…ç½®æ–‡ä»¶æ–¹å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>åˆå§‹åŒ–æ–¹å¼æœ‰å‘½ä»¤è¡Œå’Œé…ç½®æ–‡ä»¶æ–¹å¼2ç§</p><p>é…ç½®æ–‡ä»¶æ–¹å¼å¯ä»¥å‚è€ƒ<a href="https://pkg.go.dev/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta3" target="_blank" rel="noopener noreferrer">å®˜æ–¹è¯´æ˜æ–‡æ¡£</a> ï¼Œå¦‚ä¸‹æ˜¯å®˜æ–¹ç¤ºä¾‹å®Œæ•´é…ç½®æ–‡ä»¶</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> InitConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">bootstrapTokens</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;9a08jv.c0izixklcxtmnze7&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kubeadm bootstrap token&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ttl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;24h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;783bde.3f89s0fje9f38fhf&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;another bootstrap token&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">usages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> authentication</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> signing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">groups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">bootstrappers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">kubeadm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">token</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">nodeRegistration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ec2-10-100-0-1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">criSocket</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;unix:///var/run/containerd/containerd.sock&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">taints</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kubeadmNode&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;someValue&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">effect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;NoSchedule&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">kubeletExtraArgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">v</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ignorePreflightErrors</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> IsPrivilegedUser</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">imagePullPolicy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;IfNotPresent&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">localAPIEndpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">advertiseAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.100.0.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">bindPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">certificateKey</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;e6a2eb8581237ab72a4f494f30285ec12a9694d750b9785706a83bfcbbbd2204&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">skipPhases</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> addon/kube</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">proxy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">etcd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># one of local or external</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">local</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">imageRepository</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registry.k8s.io&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">imageTag</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3.2.24&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dataDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/var/lib/etcd&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">extraArgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">listen-client-urls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://10.100.0.1:2379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">serverCertSANs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ec2-10-100-0-1.compute-1.amazonaws.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">peerCertSANs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.100.0.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># external:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># endpoints:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># - &quot;10.100.0.1:2379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># - &quot;10.100.0.2:2379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># caFile: &quot;/etcd/kubernetes/pki/etcd/etcd-ca.crt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># certFile: &quot;/etcd/kubernetes/pki/etcd/etcd.crt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># keyFile: &quot;/etcd/kubernetes/pki/etcd/etcd.key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">networking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">serviceSubnet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.96.0.0/16&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">podSubnet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.244.0.0/24&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dnsDomain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cluster.local&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kubernetesVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;v1.21.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">controlPlaneEndpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.100.0.1:6443&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiServer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">extraArgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">authorization-mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Node,RBAC&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">extraVolumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;some-volume&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">hostPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/some-path&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/some-pod-path&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">readOnly</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">pathType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> File</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">certSANs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.100.1.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ec2-10-100-0-1.compute-1.amazonaws.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">timeoutForControlPlane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 4m0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">controllerManager</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">extraArgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">&quot;node-cidr-mask-size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;20&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">extraVolumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;some-volume&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">hostPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/some-path&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/some-pod-path&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">readOnly</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">pathType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> File</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">scheduler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">extraArgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.100.0.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">extraVolumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;some-volume&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">hostPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/some-path&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/some-pod-path&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">readOnly</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">pathType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> File</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">certificatesDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/kubernetes/pki&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">imageRepository</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registry.k8s.io&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">clusterName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;example-cluster&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubelet.config.k8s.io/v1beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> KubeletConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># kubelet specific options here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeproxy.config.k8s.io/v1alpha1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> KubeProxyConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># kube-proxy specific options here</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>æŒ‡å®šé…ç½®æ–‡ä»¶æ–¹å¼</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm init --config kubeadm.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>kubeadm.yaml </code> æ–‡ä»¶å†…å®¹</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">bootstrapTokens</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">groups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">bootstrappers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">kubeadm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">token</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> abcdef.0123456789abcdef</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ttl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 24h0m0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">usages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> signing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> authentication</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> InitConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">localAPIEndpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">advertiseAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.0.0.10  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æŒ‡å®šmasterèŠ‚ç‚¹å†…ç½‘IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">bindPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">nodeRegistration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">criSocket</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /run/containerd/containerd.sock  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ä½¿ç”¨ containerd çš„ Unix socket åœ°å€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">imagePullPolicy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> IfNotPresent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k8s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">master01 </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># masterèŠ‚ç‚¹ä¸»æœºå</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">taints</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ç»™masteræ·»åŠ æ±¡ç‚¹ï¼ŒmasterèŠ‚ç‚¹ä¸èƒ½è°ƒåº¦åº”ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">effect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;NoSchedule&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;node-role.kubernetes.io/master&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeproxy.config.k8s.io/v1alpha1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> KubeProxyConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> iptables  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># kube-proxy æ¨¡å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiServer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">timeoutForControlPlane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 4m0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">certificatesDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /etc/kubernetes/pki</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">clusterName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubernetes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">controllerManager</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">dns</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">etcd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">local</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dataDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /var/lib/etcd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">imageRepository</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> registry.aliyuncs.com/google_containers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kubernetesVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1.28.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">networking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dnsDomain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cluster.local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">serviceSubnet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.96.0.0/12</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">podSubnet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10.244.0.0/16  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æŒ‡å®š pod å­ç½‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">scheduler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubelet.config.k8s.io/v1beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">authentication</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">anonymous</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">webhook</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cacheTTL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">x509</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">clientCAFile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /etc/kubernetes/pki/ca.crt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">authorization</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Webhook</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">webhook</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cacheAuthorizedTTL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cacheUnauthorizedTTL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">clusterDNS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> 10.96.0.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">clusterDomain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cluster.local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">cpuManagerReconcilePeriod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">evictionPressureTransitionPeriod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">fileCheckFrequency</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">healthzBindAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 127.0.0.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">healthzPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10248</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">httpCheckFrequency</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">imageMinimumGCAge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> KubeletConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">cgroupDriver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> systemd  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># é…ç½® cgroup driver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">logging</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">memorySwap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">nodeStatusReportFrequency</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">nodeStatusUpdateFrequency</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">rotateCertificates</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">runtimeRequestTimeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">shutdownGracePeriod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">shutdownGracePeriodCriticalPods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">staticPodPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /etc/kubernetes/manifests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">streamingConnectionIdleTimeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">syncFrequency</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">volumeStatsAggPeriod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="å‘½ä»¤è¡Œæ–¹å¼">å‘½ä»¤è¡Œæ–¹å¼<a href="#å‘½ä»¤è¡Œæ–¹å¼" class="hash-link" aria-label="å‘½ä»¤è¡Œæ–¹å¼çš„ç›´æ¥é“¾æ¥" title="å‘½ä»¤è¡Œæ–¹å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>åˆå§‹åŒ–å‰ä¹Ÿå¯ä»¥æ‰§è¡Œ <code>kubeadm config images pull</code>  æŠŠéœ€è¦çš„é•œåƒå…ˆæ‹‰å–ä¸‹æ¥</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm config images pull --image-repository registry.aliyuncs.com/google_containers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>å‘½ä»¤è¡Œæ–¹å¼</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm init \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--apiserver-advertise-address=10.0.0.12 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--image-repository registry.aliyuncs.com/google_containers \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--kubernetes-version v1.30.0 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--service-cidr=10.96.0.0/16 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--pod-network-cidr=10.244.0.0/16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>init</code> æ‰§è¡ŒæˆåŠŸåä¼šæœ‰å¦‚ä¸‹è¾“å‡º</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Your Kubernetes control-plane has initialized successfully!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To start using your cluster, you need to run the following as a regular user:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  mkdir -p $HOME/.kube</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Alternatively, if you are the root user, you can run:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  export KUBECONFIG=/etc/kubernetes/admin.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You should now deploy a pod network to the cluster.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Then you can join any number of worker nodes by running the following on each as root:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm join 10.0.0.12:6443 --token a2jb7m.q7sve4dy7qdj9du3 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	--discovery-token-ca-cert-hash sha256:70bd8cbebb1209e556866de47a97a627dfb8fac3a7821702bcb48ebeffffb78c </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>kubeadm init</code> é€‰é¡¹</p>
<table><thead><tr><th>é€‰é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>--apiserver-advertise-address string</td><td>API æœåŠ¡å™¨æ‰€å…¬å¸ƒçš„å…¶æ­£åœ¨ç›‘å¬çš„ IP åœ°å€ã€‚å¦‚æœæœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤ç½‘ç»œæ¥å£ã€‚</td></tr><tr><td>--apiserver-bind-port int32</td><td>API æœåŠ¡å™¨ç»‘å®šçš„ç«¯å£ã€‚é»˜è®¤å€¼ï¼š6443</td></tr><tr><td>--apiserver-cert-extra-sans strings</td><td>ç”¨äº API Server æœåŠ¡è¯ä¹¦çš„å¯é€‰é™„åŠ ä¸»é¢˜å¤‡ç”¨åç§°ï¼ˆSANï¼‰ã€‚å¯ä»¥æ˜¯ IP åœ°å€å’Œ DNS åç§°ã€‚</td></tr><tr><td>--cert-dir string</td><td>ä¿å­˜å’Œå­˜å‚¨è¯ä¹¦çš„è·¯å¾„ã€‚é»˜è®¤å€¼ <code>/etc/kubernetes/pki</code></td></tr><tr><td>--certificate-key string</td><td>ç”¨äºåŠ å¯† kubeadm-certs Secret ä¸­çš„æ§åˆ¶å¹³é¢è¯ä¹¦çš„å¯†é’¥ã€‚</td></tr><tr><td>--config string</td><td>kubeadm é…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚</td></tr><tr><td>--control-plane-endpoint string</td><td>ä¸ºæ§åˆ¶å¹³é¢æŒ‡å®šä¸€ä¸ªç¨³å®šçš„ IP åœ°å€æˆ– DNS åç§°ã€‚</td></tr><tr><td>--cri-socket string</td><td>è¦è¿æ¥çš„ CRI å¥—æ¥å­—çš„è·¯å¾„ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™ kubeadm å°†å°è¯•è‡ªåŠ¨æ£€æµ‹æ­¤å€¼ï¼› ä»…å½“å®‰è£…äº†å¤šä¸ª CRI æˆ–å…·æœ‰éæ ‡å‡† CRI å¥—æ¥å­—æ—¶ï¼Œæ‰ä½¿ç”¨æ­¤é€‰é¡¹ã€‚</td></tr><tr><td>--dry-run</td><td>ä¸åšä»»ä½•æ›´æ”¹ï¼›åªè¾“å‡ºå°†è¦æ‰§è¡Œçš„æ“ä½œã€‚</td></tr><tr><td>--feature-gates string</td><td>ä¸€ç»„ç”¨æ¥æè¿°å„ç§åŠŸèƒ½ç‰¹æ€§çš„é”®å€¼ï¼ˆkey=valueï¼‰å¯¹ã€‚é€‰é¡¹æ˜¯ï¼šEtcdLearnerMode=true  PublicKeysECDSA=true  RootlessControlPlane=true  UpgradeAddonsBeforeControlPlane=true</td></tr><tr><td>-h, --help</td><td>init æ“ä½œçš„å¸®åŠ©å‘½ä»¤ã€‚</td></tr><tr><td>--ignore-preflight-errors strings</td><td>é”™è¯¯å°†æ˜¾ç¤ºä¸ºè­¦å‘Šçš„æ£€æŸ¥åˆ—è¡¨ï¼›ä¾‹å¦‚ï¼š<code>IsPrivilegedUser,Swap</code>ã€‚å–å€¼ä¸º <code>all</code>  æ—¶å°†å¿½ç•¥æ£€æŸ¥ä¸­çš„æ‰€æœ‰é”™è¯¯ã€‚</td></tr><tr><td>--image-repository string</td><td>é€‰æ‹©ç”¨äºæ‹‰å–æ§åˆ¶å¹³é¢é•œåƒçš„å®¹å™¨ä»“åº“ã€‚é»˜è®¤å€¼<code>registry.k8s.io</code></td></tr><tr><td>--kubernetes-version string</td><td>ä¸ºæ§åˆ¶å¹³é¢é€‰æ‹©ä¸€ä¸ªç‰¹å®šçš„ Kubernetes ç‰ˆæœ¬ã€‚é»˜è®¤å€¼ï¼š<code>stable-1</code></td></tr><tr><td>--node-name string</td><td>æŒ‡å®šèŠ‚ç‚¹çš„åç§°ã€‚</td></tr><tr><td>--patches string</td><td>å®ƒåŒ…å«åä¸º <code>target[suffix][+patchtype].extension</code> çš„æ–‡ä»¶çš„ç›®å½•çš„è·¯å¾„ã€‚ ä¾‹å¦‚ï¼Œ<code>kube-apiserver0+merge.yaml</code>æˆ–ä»…ä»…æ˜¯ <code>etcd.json</code>ã€‚ <code>target</code> å¯ä»¥æ˜¯ <code>kube-apiserver</code>ã€<code>kube-controller-manager</code>ã€<code>kube-scheduler</code>ã€<code>etcd</code>ã€<code>kubeletconfiguration</code> ä¹‹ä¸€ã€‚ <code>patchtype</code> å¯ä»¥æ˜¯ <code>strategic</code>ã€<code>merge</code> æˆ–è€… <code>json</code> ä¹‹ä¸€ï¼Œ å¹¶ä¸”å®ƒä»¬ä¸ kubectl æ”¯æŒçš„è¡¥ä¸æ ¼å¼ç›¸åŒã€‚ é»˜è®¤<br>çš„ <code>patchtype</code> æ˜¯ <code>strategic</code>ã€‚ <code>extension</code> å¿…é¡»æ˜¯<code>json</code> æˆ–<code>yaml</code>ã€‚ <code>suffix</code> æ˜¯ä¸€ä¸ªå¯é€‰å­—ç¬¦ä¸²ï¼Œå¯ç”¨äºç¡®å®šé¦–å…ˆæŒ‰å­—æ¯é¡ºåºåº”ç”¨å“ªäº›è¡¥ä¸ã€‚</td></tr><tr><td>--pod-network-cidr string</td><td>æŒ‡æ˜ Pod ç½‘ç»œå¯ä»¥ä½¿ç”¨çš„ IP åœ°å€æ®µã€‚å¦‚æœè®¾ç½®äº†è¿™ä¸ªå‚æ•°ï¼Œæ§åˆ¶å¹³é¢å°†ä¼šä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹è‡ªåŠ¨åˆ†é… CIDRã€‚</td></tr><tr><td>--service-cidr string</td><td>ä¸ºæœåŠ¡çš„è™šæ‹Ÿ IP åœ°å€å¦å¤–æŒ‡å®š IP åœ°å€æ®µã€‚é»˜è®¤å€¼ï¼š<code>10.96.0.0/12</code></td></tr><tr><td>--service-dns-domain string</td><td>ä¸ºæœåŠ¡å¦å¤–æŒ‡å®šåŸŸåï¼Œä¾‹å¦‚ï¼š<code>myorg.internal</code>ã€‚ é»˜è®¤å€¼ï¼š<code>cluster.local</code></td></tr><tr><td>--skip-certificate-key-print</td><td>ä¸è¦æ‰“å°ç”¨äºåŠ å¯†æ§åˆ¶å¹³é¢è¯ä¹¦çš„å¯†é’¥ã€‚</td></tr><tr><td>--skip-phases strings</td><td>è¦è·³è¿‡çš„é˜¶æ®µåˆ—è¡¨ã€‚</td></tr><tr><td>--skip-token-print</td><td>è·³è¿‡æ‰“å° <code>kubeadm init</code> ç”Ÿæˆçš„é»˜è®¤å¼•å¯¼ä»¤ç‰Œã€‚</td></tr><tr><td>--token string</td><td>è¿™ä¸ªä»¤ç‰Œç”¨äºå»ºç«‹æ§åˆ¶å¹³é¢èŠ‚ç‚¹ä¸å·¥ä½œèŠ‚ç‚¹é—´çš„åŒå‘é€šä¿¡ã€‚ æ ¼å¼ä¸º <code>[a-z0-9]{6}.[a-z0-9]{16}</code> - ç¤ºä¾‹ï¼š<code>abcdef.0123456789abcdef</code></td></tr><tr><td>--token-ttl duration</td><td>ä»¤ç‰Œè¢«è‡ªåŠ¨åˆ é™¤ä¹‹å‰çš„æŒç»­æ—¶é—´ï¼ˆä¾‹å¦‚ 1sï¼Œ2mï¼Œ3hï¼‰ã€‚å¦‚æœè®¾ç½®ä¸º <code>0</code>ï¼Œåˆ™ä»¤ç‰Œå°†æ°¸ä¸è¿‡æœŸã€‚</td></tr><tr><td>--upload-certs</td><td>å°†æ§åˆ¶å¹³é¢è¯ä¹¦ä¸Šä¼ åˆ° kubeadm-certs Secretã€‚</td></tr></tbody></table>
<p><strong><code>Init</code> å‘½ä»¤çš„å·¥ä½œæµç¨‹</strong></p>
<p>1.åœ¨åšå‡ºå˜æ›´å‰è¿è¡Œä¸€ç³»åˆ—çš„é¢„æ£€é¡¹æ¥éªŒè¯ç³»ç»ŸçŠ¶æ€ã€‚ä¸€äº›æ£€æŸ¥é¡¹ç›®ä»…ä»…è§¦å‘è­¦å‘Šï¼Œ å…¶å®ƒçš„åˆ™ä¼šè¢«è§†ä¸ºé”™è¯¯å¹¶ä¸”é€€å‡º kubeadmï¼Œé™¤éé—®é¢˜å¾—åˆ°è§£å†³æˆ–è€…ç”¨æˆ·æŒ‡å®šäº† <code>--ignore-preflight-errors=&lt;é”™è¯¯åˆ—è¡¨&gt;</code> å‚æ•°ã€‚</p>
<p>2.ç”Ÿæˆä¸€ä¸ªè‡ªç­¾åçš„ CA è¯ä¹¦æ¥ä¸ºé›†ç¾¤ä¸­çš„æ¯ä¸€ä¸ªç»„ä»¶å»ºç«‹èº«ä»½æ ‡è¯†ã€‚ ç”¨æˆ·å¯ä»¥é€šè¿‡å°†å…¶æ”¾å…¥ <code>--cert-dir</code> é…ç½®çš„è¯ä¹¦ç›®å½•ä¸­ï¼ˆé»˜è®¤ä¸º <code>/etc/kubernetes/pki</code>ï¼‰ æ¥æä¾›ä»–ä»¬è‡ªå·±çš„ CA è¯ä¹¦ä»¥åŠ/æˆ–è€…å¯†é’¥ã€‚ APIServer è¯ä¹¦å°†ä¸ºä»»ä½• <code>--apiserver-cert-extra-sans</code> å‚æ•°å€¼æä¾›é™„åŠ çš„ SAN æ¡ç›®ï¼Œå¿…è¦æ—¶å°†å…¶å°å†™ã€‚</p>
<p>3.å°† kubeconfig æ–‡ä»¶å†™å…¥ <code>/etc/kubernetes/</code> ç›®å½•ä»¥ä¾¿ kubeletã€æ§åˆ¶å™¨ç®¡ç†å™¨å’Œè°ƒåº¦å™¨ç”¨æ¥è¿æ¥åˆ° API æœåŠ¡å™¨ï¼Œå®ƒä»¬æ¯ä¸€ä¸ªéƒ½æœ‰ è‡ªå·±çš„èº«ä»½æ ‡è¯†ï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ªåä¸º <code>admin.conf</code> çš„ç‹¬ç«‹çš„ kubeconfig æ–‡ä»¶ï¼Œç”¨äºç®¡ç†æ“ä½œã€‚</p>
<p>4.ä¸º API æœåŠ¡å™¨ã€æ§åˆ¶å™¨ç®¡ç†å™¨å’Œè°ƒåº¦å™¨ç”Ÿæˆé™æ€ Pod çš„æ¸…å•æ–‡ä»¶ã€‚å‡ä½¿æ²¡æœ‰æä¾›ä¸€ä¸ªå¤–éƒ¨çš„ etcd æœåŠ¡çš„è¯ï¼Œä¹Ÿä¼šä¸º etcd ç”Ÿæˆä¸€ä»½é¢å¤–çš„é™æ€ Pod æ¸…å•æ–‡ä»¶</p>
<p>é™æ€ Pod çš„æ¸…å•æ–‡ä»¶è¢«å†™å…¥åˆ° <code>/etc/kubernetes/manifests</code> ç›®å½•ï¼› kubelet ä¼šç›‘è§†è¿™ä¸ªç›®å½•ä»¥ä¾¿åœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™åˆ›å»º Podã€‚</p>
<p>ä¸€æ—¦æ§åˆ¶å¹³é¢çš„ Pod éƒ½è¿è¡Œèµ·æ¥ï¼Œ<code>kubeadm init</code> çš„å·¥ä½œæµç¨‹å°±ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚</p>
<p>5.å¯¹æ§åˆ¶å¹³é¢èŠ‚ç‚¹åº”ç”¨æ ‡ç­¾å’Œæ±¡ç‚¹æ ‡è®°ä»¥ä¾¿ä¸ä¼šåœ¨å®ƒä¸Šé¢è¿è¡Œå…¶å®ƒçš„å·¥ä½œè´Ÿè½½ã€‚</p>
<p>6.ç”Ÿæˆä»¤ç‰Œï¼Œå°†æ¥å…¶ä»–èŠ‚ç‚¹å¯ä½¿ç”¨è¯¥ä»¤ç‰Œå‘æ§åˆ¶å¹³é¢æ³¨å†Œè‡ªå·±ã€‚å¦‚ <a href="https://kubernetes.io/zh-cn/docs/reference/setup-tools/kubeadm/kubeadm-token/" target="_blank" rel="noopener noreferrer">kubeadm token</a> æ–‡æ¡£æ‰€è¿°ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©é€šè¿‡ <code>--token</code> æä¾›ä»¤ç‰Œã€‚</p>
<p>7.ä¸ºäº†ä½¿å¾—èŠ‚ç‚¹èƒ½å¤Ÿéµç…§<a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/bootstrap-tokens/" target="_blank" rel="noopener noreferrer">å¯åŠ¨å¼•å¯¼ä»¤ç‰Œ</a>å’Œ <a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/kubelet-tls-bootstrapping/" target="_blank" rel="noopener noreferrer">TLS å¯åŠ¨å¼•å¯¼</a> è¿™ä¸¤ä»½æ–‡æ¡£ä¸­æè¿°çš„æœºåˆ¶åŠ å…¥åˆ°é›†ç¾¤ä¸­ï¼Œkubeadm ä¼šæ‰§è¡Œæ‰€æœ‰çš„å¿…è¦é…ç½®ï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ª ConfigMap æä¾›æ·»åŠ é›†ç¾¤èŠ‚ç‚¹æ‰€éœ€çš„ä¿¡æ¯ï¼Œå¹¶ä¸ºè¯¥ ConfigMap è®¾ç½®ç›¸å…³çš„ RBAC è®¿é—®è§„åˆ™ã€‚</li>
<li>å…è®¸å¯åŠ¨å¼•å¯¼ä»¤ç‰Œè®¿é—® CSR ç­¾å APIã€‚</li>
<li>é…ç½®è‡ªåŠ¨ç­¾å‘æ–°çš„ CSR è¯·æ±‚ã€‚</li>
</ul>
<p>æ›´å¤šç›¸å…³ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="https://kubernetes.io/zh-cn/docs/reference/setup-tools/kubeadm/kubeadm-join/" target="_blank" rel="noopener noreferrer">kubeadm join</a>ã€‚</p>
<p>8.é€šè¿‡ API æœåŠ¡å™¨å®‰è£…ä¸€ä¸ª DNS æœåŠ¡å™¨ (CoreDNS) å’Œ kube-proxy é™„åŠ ç»„ä»¶ã€‚ åœ¨ Kubernetes v1.11 å’Œæ›´é«˜ç‰ˆæœ¬ä¸­ï¼ŒCoreDNS æ˜¯é»˜è®¤çš„ DNS æœåŠ¡å™¨ã€‚ è¯·æ³¨æ„ï¼Œå°½ç®¡å·²éƒ¨ç½² DNS æœåŠ¡å™¨ï¼Œä½†ç›´åˆ°å®‰è£… CNI æ—¶æ‰è°ƒåº¦å®ƒã€‚</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>è­¦å‘Š</div><div class="admonitionContent_BuS1"><p>ä» v1.18 å¼€å§‹ï¼Œåœ¨ kubeadm ä¸­ä½¿ç”¨ kube-dns çš„æ”¯æŒå·²è¢«åºŸå¼ƒï¼Œå¹¶å·²åœ¨ v1.21 ç‰ˆæœ¬ä¸­ç§»é™¤ã€‚</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ‹·è´-kubeconfig-æ–‡ä»¶">æ‹·è´ <code>kubeconfig</code> æ–‡ä»¶<a href="#æ‹·è´-kubeconfig-æ–‡ä»¶" class="hash-link" aria-label="æ‹·è´-kubeconfig-æ–‡ä»¶çš„ç›´æ¥é“¾æ¥" title="æ‹·è´-kubeconfig-æ–‡ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p $HOME/.kube</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chown $(id -u):$(id -g) $HOME/.kube/config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ·»åŠ nodeèŠ‚ç‚¹">æ·»åŠ nodeèŠ‚ç‚¹<a href="#æ·»åŠ nodeèŠ‚ç‚¹" class="hash-link" aria-label="æ·»åŠ nodeèŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥" title="æ·»åŠ nodeèŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>é€šè¿‡è¿è¡Œ <code>kubeadm init</code> æœ€åè¾“å‡ºçš„å‘½ä»¤</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm join 10.0.0.12:6443 --token a2jb7m.q7sve4dy7qdj9du3 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	--discovery-token-ca-cert-hash sha256:70bd8cbebb1209e556866de47a97a627dfb8fac3a7821702bcb48ebeffffb78c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŸ¥çœ‹token</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä»¤ç‰Œä¼šåœ¨ 24 å°æ—¶åè¿‡æœŸã€‚å¦‚æœè¦åœ¨å½“å‰ä»¤ç‰Œè¿‡æœŸåå°†èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼Œ åˆ™å¯ä»¥é€šè¿‡åœ¨æ§åˆ¶å¹³é¢èŠ‚ç‚¹ä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°ä»¤ç‰Œï¼š</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm token create</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubeadm token list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TOKEN                     TTL         EXPIRES                USAGES                   DESCRIPTION                                                EXTRA GROUPS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">a2jb7m.q7sve4dy7qdj9du3   23h         2023-11-02T06:36:56Z   authentication,signing   The default bootstrap token generated by &#x27;kubeadm init&#x27;.   system:bootstrappers:kubeadm:default-node-token</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŸ¥çœ‹sha256</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;    openssl dgst -sha256 -hex | sed &#x27;s/^.* //&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">70bd8cbebb1209e556866de47a97a627dfb8fac3a7821702bcb48ebeffffb78c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŒæ—¶æŸ¥çœ‹tokenå’Œsha256</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>æ³¨æ„</div><div class="admonitionContent_BuS1"><p>æ‰§è¡Œæ­¤å‘½ä»¤ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªtoken</p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubeadm token create --print-join-command</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm join 10.0.0.12:6443 --token knn1yv.a0qmgazqdo3mpgb2 --discovery-token-ca-cert-hash sha256:70bd8cbebb1209e556866de47a97a627dfb8fac3a7821702bcb48ebeffffb78c </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæƒ³è¦åœ¨masterèŠ‚ç‚¹ä¸Šè¿›è¡Œè°ƒåº¦podï¼Œä¾‹å¦‚å•æœº Kubernetes é›†ç¾¤ï¼Œåº”è¯¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl taint nodes --all node-role.kubernetes.io/control-plane-</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å®‰è£…ç½‘ç»œæ’ä»¶">å®‰è£…ç½‘ç»œæ’ä»¶<a href="#å®‰è£…ç½‘ç»œæ’ä»¶" class="hash-link" aria-label="å®‰è£…ç½‘ç»œæ’ä»¶çš„ç›´æ¥é“¾æ¥" title="å®‰è£…ç½‘ç»œæ’ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#pod-network" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p>
<p>å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹k8s <a href="https://kubernetes.io/zh-cn/docs/concepts/cluster-administration/addons/#networking-and-network-policy" target="_blank" rel="noopener noreferrer">æ”¯æŒçš„ç½‘ç»œæ’ä»¶</a></p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>æ³¨æ„</div><div class="admonitionContent_BuS1"><p><strong>ä½ å¿…é¡»éƒ¨ç½²ä¸€ä¸ªåŸºäº Pod ç½‘ç»œæ’ä»¶çš„ <a href="https://kubernetes.io/zh-cn/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/" target="_blank" rel="noopener noreferrer">å®¹å™¨ç½‘ç»œæ¥å£</a> (CNI)ï¼Œä»¥ä¾¿ä½ çš„ Pod å¯ä»¥ç›¸äº’é€šä¿¡ã€‚ åœ¨å®‰è£…ç½‘ç»œä¹‹å‰ï¼Œé›†ç¾¤ DNS (CoreDNS) å°†ä¸ä¼šå¯åŠ¨ã€‚</strong></p><ul>
<li>
<p>æ³¨æ„ä½ çš„ Pod ç½‘ç»œä¸å¾—ä¸ä»»ä½•ä¸»æœºç½‘ç»œé‡å ï¼š å¦‚æœæœ‰é‡å ï¼Œä½ å¾ˆå¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚ ï¼ˆå¦‚æœä½ å‘ç°ç½‘ç»œæ’ä»¶çš„é¦–é€‰ Pod ç½‘ç»œä¸æŸäº›ä¸»æœºç½‘ç»œä¹‹é—´å­˜åœ¨å†²çªï¼Œ åˆ™åº”è€ƒè™‘ä½¿ç”¨ä¸€ä¸ªåˆé€‚çš„ CIDR å—æ¥ä»£æ›¿ï¼Œ ç„¶ååœ¨æ‰§è¡Œ <code>kubeadm init</code> æ—¶ä½¿ç”¨ <code>--pod-network-cidr</code> å‚æ•°å¹¶åœ¨ä½ çš„ç½‘ç»œæ’ä»¶çš„ YAML ä¸­æ›¿æ¢å®ƒï¼‰ã€‚</p>
</li>
<li>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>kubeadm</code> å°†é›†ç¾¤è®¾ç½®ä¸ºä½¿ç”¨å’Œå¼ºåˆ¶ä½¿ç”¨ <a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener noreferrer">RBAC</a>ï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰ã€‚ ç¡®ä¿ä½ çš„ Pod ç½‘ç»œæ’ä»¶æ”¯æŒ RBACï¼Œä»¥åŠç”¨äºéƒ¨ç½²å®ƒçš„æ¸…å•ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
</li>
<li>
<p>å¦‚æœè¦ä¸ºé›†ç¾¤ä½¿ç”¨ IPv6ï¼ˆåŒåè®®æ ˆæˆ–ä»…å•åè®®æ ˆ IPv6 ç½‘ç»œï¼‰ï¼Œ è¯·ç¡®ä¿ä½ çš„ Pod ç½‘ç»œæ’ä»¶æ”¯æŒ IPv6ã€‚ IPv6 æ”¯æŒå·²åœ¨ CNI <a href="https://github.com/containernetworking/cni/releases/tag/v0.6.0" target="_blank" rel="noopener noreferrer">v0.6.0</a> ç‰ˆæœ¬ä¸­æ·»åŠ ã€‚</p>
</li>
</ul></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="flannel">flannel<a href="#flannel" class="hash-link" aria-label="flannelçš„ç›´æ¥é“¾æ¥" title="flannelçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/flannel-io/flannel" target="_blank" rel="noopener noreferrer">flannnel github</a></p>
<p>ä¸‹è½½æ’ä»¶</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export VERSION=0.23.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://github.com/flannel-io/flannel/releases/download/v${VERSION}/kube-flannel.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>è¯´æ˜</div><div class="admonitionContent_BuS1"><p>å¦‚æœé›†ç¾¤podç½‘ç»œä¸æ˜¯ <code>10.244.0.0/16</code> ï¼Œåˆ™éœ€è¦ä¿®æ”¹ <code>kube-flannel.yml</code> ä¸­ <code>Networ</code> å­—æ®µ</p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f kube-flannel.yml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŸ¥çœ‹æ‰€æœ‰podçŠ¶æ€</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl get pod -A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAMESPACE      NAME                          READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-flannel   kube-flannel-ds-45wk7         1/1     Running   0          3m36s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-flannel   kube-flannel-ds-nl52c         1/1     Running   0          3m36s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    coredns-66f779496c-bpsx7      1/1     Running   0          78m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    coredns-66f779496c-mdpkb      1/1     Running   0          78m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    etcd-k8s                      1/1     Running   0          78m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    kube-apiserver-k8s            1/1     Running   0          78m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    kube-controller-manager-k8s   1/1     Running   0          78m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    kube-proxy-6kw6b              1/1     Running   0          78m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    kube-proxy-t2s76              1/1     Running   0          63m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system    kube-scheduler-k8s            1/1     Running   0          78m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…å®Œç½‘ç»œæ’ä»¶åï¼Œå½“æ‰€æœ‰podéƒ½ä¸º <code>running</code> çŠ¶æ€åï¼Œé›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹çŠ¶æ€æ‰ä¸º <code>Ready</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl get no</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME       STATUS   ROLES           AGE   VERSION</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k8s-master Ready    control-plane   78m   v1.28.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k8s-node   Ready    &lt;none&gt;          63m   v1.28.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="calico">calico<a href="#calico" class="hash-link" aria-label="calicoçš„ç›´æ¥é“¾æ¥" title="calicoçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><a href="https://github.com/projectcalico/calico" target="_blank" rel="noopener noreferrer">calico github</a></p>
<p><a href="https://docs.tigera.io/" target="_blank" rel="noopener noreferrer">calicoå®˜ç½‘</a></p>
<p>å®‰è£…calico tigera-operatorå’Œè‡ªå®šä¹‰èµ„æº</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create -f https://raw.githubusercontent.com/projectcalico/calico/v3.27.0/manifests/tigera-operator.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…calico</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>æ³¨æ„</div><div class="admonitionContent_BuS1"><p><code>custom-resources.yaml</code> æ–‡ä»¶ä¸­çš„podç½‘æ®µé»˜è®¤æ˜¯ <code>192.168.0.0/16</code> ï¼Œå¦‚æœé›†ç¾¤çš„podç½‘æ®µä¸æ˜¯ <code>192.168.0.0/16</code> åˆ™éœ€è¦ä¿®æ”¹</p></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create -f https://raw.githubusercontent.com/projectcalico/calico/v3.27.0/manifests/custom-resources.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŸ¥çœ‹æ‰€æœ‰podçŠ¶æ€</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl get pod -A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAMESPACE          NAME                                       READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-apiserver   calico-apiserver-867b8496d6-g5bln          1/1     Running   0          2m8s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-apiserver   calico-apiserver-867b8496d6-knbdj          1/1     Running   0          2m8s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      calico-kube-controllers-79f555774b-t4szx   1/1     Running   0          3m25s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      calico-node-6bqs7                          1/1     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      calico-node-6zr9b                          1/1     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      calico-node-gf4m9                          1/1     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      calico-node-pcsvl                          1/1     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      calico-typha-b4884f588-g8z88               1/1     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      calico-typha-b4884f588-s59sv               1/1     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      csi-node-driver-b548q                      2/2     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      csi-node-driver-fjmvl                      2/2     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      csi-node-driver-n8sk8                      2/2     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calico-system      csi-node-driver-qzvxr                      2/2     Running   0          17m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        coredns-66f779496c-62d8l                   1/1     Running   0          46m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        coredns-66f779496c-8ks6d                   1/1     Running   0          46m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        etcd-k8s-master01                          1/1     Running   0          47m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        kube-apiserver-k8s-master01                1/1     Running   0          47m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        kube-controller-manager-k8s-master01       1/1     Running   0          47m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        kube-proxy-hnkz2                           1/1     Running   0          46m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        kube-proxy-ncx7z                           1/1     Running   0          46m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        kube-proxy-qmf5p                           1/1     Running   0          46m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        kube-proxy-wpzbh                           1/1     Running   0          46m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kube-system        kube-scheduler-k8s-master01                1/1     Running   0          47m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tigera-operator    tigera-operator-55585899bf-c65gw           1/1     Running   0          17m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…å®Œç½‘ç»œæ’ä»¶åï¼Œå½“æ‰€æœ‰podéƒ½ä¸º <code>running</code> çŠ¶æ€åï¼Œé›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹çŠ¶æ€æ‰ä¸º <code>Ready</code></p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl get no</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME           STATUS   ROLES           AGE   VERSION</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k8s-master01   Ready    control-plane   47m   v1.28.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k8s-node01     Ready    &lt;none&gt;          47m   v1.28.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k8s-node02     Ready    &lt;none&gt;          46m   v1.28.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k8s-node03     Ready    &lt;none&gt;          46m   v1.28.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡ä»¶é€‰é¡¹å¡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmåœ¨Rocky linuxä¸Šå®‰è£…k8sé›†ç¾¤"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">ä½¿ç”¨kubeadmåœ¨Rocky linuxä¸Šå®‰è£…k8sé›†ç¾¤</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/äº‘åŸç”Ÿ/k8s/k8så®‰è£…/ä½¿ç”¨kubeadmæ­å»º v1.22.2ç‰ˆæœ¬ kubernetesé›†ç¾¤"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">ä½¿ç”¨kubeadmæ­å»º v1.22.2ç‰ˆæœ¬ kubernetesé›†ç¾¤</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#å®  éªŒç¯å¢ƒ" class="table-of-contents__link toc-highlight">å®éªŒç¯å¢ƒ</a></li><li><a href="#å‡†å¤‡å¼€å§‹" class="table-of-contents__link toc-highlight">å‡†å¤‡å¼€å§‹</a></li><li><a href="#ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š-mac-åœ°å€å’Œ-product_uuid-çš„å”¯ä¸€æ€§" class="table-of-contents__link toc-highlight">ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š MAC åœ°å€å’Œ product_uuid çš„å”¯ä¸€æ€§</a></li><li><a href="#æ£€æŸ¥æ‰€éœ€ç«¯å£" class="table-of-contents__link toc-highlight">æ£€æŸ¥æ‰€éœ€ç«¯å£</a></li><li><a href="#å®‰è£…å®¹å™¨è¿è¡Œæ—¶" class="table-of-contents__link toc-highlight">å®‰è£…å®¹å™¨è¿è¡Œæ—¶</a><ul><li><a href="#å®¹å™¨è¿è¡Œæ—¶ç±»å‹" class="table-of-contents__link toc-highlight">å®¹å™¨è¿è¡Œæ—¶ç±»å‹</a></li><li><a href="#å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶" class="table-of-contents__link toc-highlight">å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶</a><ul><li><a href="#è½¬å‘-ipv4-å¹¶è®©-iptables-çœ‹åˆ°æ¡¥æ¥æµé‡" class="table-of-contents__link toc-highlight">è½¬å‘ IPv4 å¹¶è®© iptables çœ‹åˆ°æ¡¥æ¥æµé‡</a></li></ul></li><li><a href="#cgroupé©±åŠ¨" class="table-of-contents__link toc-highlight">cgroupé©±åŠ¨</a></li><li><a href="#cgroupfs-é©±åŠ¨" class="table-of-contents__link toc-highlight">cgroupfs é©±åŠ¨</a></li><li><a href="#systemd-cgroup-é©±åŠ¨" class="table-of-contents__link toc-highlight">systemd cgroup é©±åŠ¨</a></li><li><a href="#å®‰è£…containerd" class="table-of-contents__link toc-highlight">å®‰è£…containerd</a><ul><li><a href="#å®‰è£…containerd-1" class="table-of-contents__link toc-highlight">å®‰è£…containerd</a></li><li><a href="#å®‰è£…runc" class="table-of-contents__link toc-highlight">å®‰è£…runc</a></li><li><a href="#å®‰è£…cniæ’ä»¶" class="table-of-contents__link toc-highlight">å®‰è£…CNIæ’ä»¶</a></li></ul></li><li><a href="#é…ç½®containerd" class="table-of-contents__link toc-highlight">é…ç½®containerd</a><ul><li><a href="#åˆ›å»ºcontainerdé…ç½®æ–‡ä»¶" class="table-of-contents__link toc-highlight">åˆ›å»ºcontainerdé…ç½®æ–‡ä»¶</a></li><li><a href="#é…ç½®-systemd-group-é©±åŠ¨" class="table-of-contents__link toc-highlight">é…ç½® systemd group é©±åŠ¨</a></li><li><a href="#ä¿®æ”¹-pause-é•œåƒåœ°å€" class="table-of-contents__link toc-highlight">ä¿®æ”¹ pause é•œåƒåœ°å€</a></li><li><a href="#é…ç½®containerdé•œåƒä»“åº“åŠ é€Ÿ" class="table-of-contents__link toc-highlight">é…ç½®containerdé•œåƒä»“åº“åŠ é€Ÿ</a></li><li><a href="#å®‰è£…cri-toolså¯é€‰" class="table-of-contents__link toc-highlight">å®‰è£…cri-toolsï¼ˆå¯é€‰ï¼‰</a></li><li><a href="#å®‰è£…nerdctlå¯é€‰" class="table-of-contents__link toc-highlight">å®‰è£…nerdctlï¼ˆå¯é€‰ï¼‰</a><ul><li><a href="#å®‰è£…å…¶ä»–ç»„ä»¶" class="table-of-contents__link toc-highlight">å®‰è£…å…¶ä»–ç»„ä»¶</a><ul><li><a href="#cni-plugins-cni-æ’ä»¶-" class="table-of-contents__link toc-highlight">CNI plugins CNI æ’ä»¶ </a></li><li><a href="#buildkit-æ„å»ºå¥—ä»¶--å¯é€‰" class="table-of-contents__link toc-highlight">BuildKit æ„å»ºå¥—ä»¶  ï¼ˆå¯é€‰ï¼‰</a></li><li><a href="#rootlesskit-and-slirp4netns-å¯é€‰" class="table-of-contents__link toc-highlight">RootlessKit and slirp4netns ï¼ˆå¯é€‰ï¼‰</a></li></ul></li></ul></li><li><a href="#dockerå’Œcontainerdå¸¸ç”¨å‘½ä»¤å¯¹æ¯”" class="table-of-contents__link toc-highlight">dockerå’Œcontainerdå¸¸ç”¨å‘½ä»¤å¯¹æ¯”</a></li></ul></li></ul></li><li><a href="#å®‰è£…kubeadmkubeletkubectl" class="table-of-contents__link toc-highlight">å®‰è£…kubeadmã€kubeletã€kubectl</a><ul><li><a href="#é…ç½®yumæº" class="table-of-contents__link toc-highlight">é…ç½®yumæº</a></li><li><a href="#å®‰è£…-kubeletkubeadm-å’Œ-kubectlå¹¶å¯ç”¨-kubelet-ä»¥ç¡®ä¿å®ƒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨" class="table-of-contents__link toc-highlight">å®‰è£… kubeletã€kubeadm å’Œ kubectlï¼Œå¹¶å¯ç”¨ kubelet ä»¥ç¡®ä¿å®ƒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨</a></li><li><a href="#è®¾ç½®-kubectl-å‘½ä»¤è¡¥å…¨" class="table-of-contents__link toc-highlight">è®¾ç½® <code>kubectl</code> å‘½ä»¤è¡¥å…¨</a></li></ul></li><li><a href="#ä½¿ç”¨kubeadmåˆ›å»ºé›†ç¾¤" class="table-of-contents__link toc-highlight">ä½¿ç”¨kubeadmåˆ›å»ºé›†ç¾¤</a><ul><li><a href="#åˆå§‹åŒ–masterèŠ‚ç‚¹" class="table-of-contents__link toc-highlight">åˆå§‹åŒ–masterèŠ‚ç‚¹</a><ul><li><a href="#åˆå§‹åŒ–æ–¹å¼" class="table-of-contents__link toc-highlight">åˆå§‹åŒ–æ–¹å¼</a><ul><li><a href="#é…ç½®æ–‡ä»¶æ–¹å¼" class="table-of-contents__link toc-highlight">é…ç½®æ–‡ä»¶æ–¹å¼</a></li><li><a href="#å‘½ä»¤è¡Œæ–¹å¼" class="table-of-contents__link toc-highlight">å‘½ä»¤è¡Œæ–¹å¼</a></li></ul></li></ul></li><li><a href="#æ‹·è´-kubeconfig-æ–‡ä»¶" class="table-of-contents__link toc-highlight">æ‹·è´ <code>kubeconfig</code> æ–‡ä»¶</a></li><li><a href="#æ·»åŠ nodeèŠ‚ç‚¹" class="table-of-contents__link toc-highlight">æ·»åŠ nodeèŠ‚ç‚¹</a></li><li><a href="#å®‰è£…ç½‘ç»œæ’ä»¶" class="table-of-contents__link toc-highlight">å®‰è£…ç½‘ç»œæ’ä»¶</a><ul><li><a href="#flannel" class="table-of-contents__link toc-highlight">flannel</a></li><li><a href="#calico" class="table-of-contents__link toc-highlight">calico</a></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">ç¬”è®°</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 æ³¡æ³¡åè‚¥çš‚o</div></div></div></footer></div>
</body>
</html>